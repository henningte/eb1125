---
title: "Peat Oxic and Anoxic Controls of *Sphagnum* Decomposition Rates in the Holocene Peatland Model Decomposition Module Estimated from Litterbag Data"
date: "`r format(Sys.time(), '%d %B, %Y')`"
journal: "`r rticles::copernicus_journal_abbreviations(journal_name = 'Earth System Dynamics')`"
author:
  - given_name: Henning
    surname: Teickner
    affiliation: "1, 2"
    email: henning.teickner@uni-muenster.de
    corresponding: true
  - given_name: Edzer
    surname: Pebesma
    affiliation: 2
    email: edzer.pebesma@uni-muenster.de
  - given_name: Klaus-Holger
    surname: Knorr
    affiliation: "1"
    email: klaus-holger.knorr@uni-muenster.de
# If you have more than one corresponding author, add them manually using the following structure (note the commas):
# Two authors: Daniel Nüst (daniel.nuest@uni-muenster.de) and Josiah Carberry (j.carberry@orcid.org)
# Three authors or more: Daniel Nüst (daniel.nuest@uni-muenster.de), Josiah Carberry (j.carberry@orcid.org), and Markus Konkol (m.konkol@wwu.de)
# If the following line is uncommented, the "corresponding: true" above are ignored
#correspongdingauthors: Daniel Nüst (daniel.nuest@uni-muenster.de) and Josiah Carberry (j.carberry@orcid.org)
# If an author is deceased, please mark the respective author name(s) with a dagger '†' and add a further affiliation; put the decease date in the 'address' field", see 'Nikolaus Copernicus' in template.
# If authors contributed equally, please mark the respective author names with an asterisk '*' and add a further affiliation: 'These authors contributed equally to this work.'", see template.
affiliation:
  - code: 1
    address: Ecohydrology & Biogeochemistry Group, Institute of Landscape Ecology, University of Münster, 48149, Germany
  - code: 2
    address: Spatiotemporal Modelling Lab, Institute for Geoinformatics, University of Münster, 48149, Germany
running:
  title: "Underestimated anaerobic decomposition rates in the HPM"
  author: Teickner et al.
# This section is mandatory even if you declare that no competing interests are present.
competinginterests: |
  The authors declare no competing interests.
# See https://publications.copernicus.org/for_authors/licence_and_copyright.html, normally used for transferring the copyright, if needed. 
# Note: additional copyright statements for affiliated software or data need to be placed in the data availability section. 
# copyrightstatement: |
### The following commands are for the statements about the availability of data sets and/or software code corresponding to the manuscript.
### It is strongly recommended to make use of these sections in case data sets and/or software code have been part of your research the article is based on.
### Note: unless stated otherwise, software and data affiliated with the manuscript are assumed to be published under the same licence as the article (currently Creative Commons 4.0)
availability:
  #code: |
  #  use this to add a statement when having only software code available
  #data: |
  #  use this to add a statement when having only data sets available
  codedata: |
    Data and code to reproduce this manuscript are available from @Teickner.2024e. The data used in this study are derived from @Teickner.2024c. An R package to make predictions for litterbag experiments with model `r hpmd_model_id_to_name_2("3-4")` is available from @Teickner.2024b.
#  sample: |
#    use this section when having geoscientific samples available
#videosupplement: |
#  use this section when having video supplements available
authorcontribution: |
  HT: Conceptualization, methodology, software, validation, formal analysis, investigation, data curation, writing - original draft, visualization, project administration. EP: supervision, funding acquisition, writing - review & editing. KHK: supervision, funding acquisition, writing - review & editing.
# disclaimer: |
#   We like Copernicus.
acknowledgements: |
  This study was funded by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) grant no. KN 929/23-1 to Klaus-Holger Knorr and grant no. PE 1632/18-1 to Edzer Pebesma.
link-citations: true
csl: "templates/copernicus-publications.csl"
keywords: |
  Holocene Peatland Model, peatland, litterbag, decomposition, anoxic, oxic, Bayesian data analysis
output: 
  bookdown::pdf_book:
    base_format: rticles::copernicus_article
    fig_caption: yes
    keep_tex: true
bibliography: references.bib
header-includes:
  - \usepackage{float}
  - \usepackage{booktabs}
  - \usepackage{bm}
  - \usepackage{xr} \externaldocument[si-]{hpmd-supporting-info}
# fontsize: 12pt
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, fig.pos = 'H', fig.align = 'center')

# packages
library(ggplot2)
library(tibble)
library(dplyr)
library(knitr)
library(tidyr)
library(dplyr)
library(ggtext)
library(patchwork)
library(quantities)
library(units)
library(posterior)
library(kableExtra)
library(targets)
```


# Introduction

Decomposition is one of the major controls of how much carbon (C) peatlands can store. Compared to other ecosystems, northern peatlands usually have small decomposition rates because of cold temperatures, high water table levels, acidic pH value, and litter that does not decompose fast even under environmental conditions favorable for decomposition  [@vanBreemen.1995; @Rydin.2013]. These slow decomposition rates caused northern peatlands to accumulate at least 400 Gt C [@Yu.2012; @Nichols.2019] during the Holocene and changes in the controls of decomposition rates may cause them to loose considerable amounts of C to the atmosphere under climate and land use changes [@Frolking.2011; @Loisel.2017]. 

Peatland models are used to better understand past C accumulation and to predict future changes in peat C stocks, but because of the long time scales which have to be considered, they are difficult to test. Past studies have compared site-adapted simulations of peat height, age, C and N stocks, macrofossil composition, and water table level predicted by peatland models against peat core data [e.g., @Frolking.2010; @Tuittila.2013; @Treat.2021; @Zhao.2022], and have shown that  existing peatland models can reproduce observed patterns to some extent. However, these tests suffer from two problems. First, they cannot reliably identify the parameter values or model equations that cause discrepancies between model predictions and measurements because they test entire peatland models against observed data. Second, there often are large uncertainties on both sides of the test; peatland models have large uncertainties in parameter values and model structure and these may produce a range of predictions as illustrated by uncertainty analyses [e.g., @Quillet.2013, @Quillet.2013a] and model intercomparisons [e.g., @Zhao.2022]. Observed data also has uncertainty from measurements, peat dating, or simply missing data, for example for past precipitation. Large uncertainties can make tests inconclusive, no matter how much data we use. As a consequence, there remains large and often not quantified uncertainty about parameter values that control decomposition rates.

An alternative that avoids some of these problems is to test only some part of a model while taking into account relevant uncertainty sources. To estimate uncertainties in and test values of parameters that directly control decomposition rates, such a test could address the decomposition module of a peatland model. For example, in the Holocene Peatland Model (HPM) [@Frolking.2010], we only need to know litter species, peat degree of saturation,  the depth of the litter below the peat surface, water table depth, and only five parameters to predict decomposition rates. The predictions can be compared to decomposition rates estimated from litterbag data and therefore future litterbag studies can directly test whether discrepancies identified in such a test are replicable. Admittedly, such a test is restricted to short time ranges and not representative for long-term decomposition rates which may differ from that of fresh litter [e.g., @Frolking.2001], but future tests with different scope and applications of the model will benefit from the reduced parameter uncertainties and can consider where the model fails already on short time scales.

A test of decomposition modules is relevant because of the importance of decomposition for long-term C accumulation in peatlands. Previous sensitivity analyses of the HPM and applications to peat cores suggest that the anoxia scale length ($c_2$), the parameter controlling how anaerobic decomposition rates are limited by electron acceptor depletion and accumulation of decomposition products, can result in a doubling of accumulated C, depending on climate conditions [@Frolking.2010; @Quillet.2013a; @Kurnianto.2015]. These sensitivity analyses used assumed parameter ranges that are not informed by litterbag experiments. A test of only the HPM decomposition module can provide better estimates for $c_2$ and may therefore help to reduce uncertainties in predicted C accumulation rates.

Currently, litterbag experiments are not as extensively used for testing peatland models as they could and only a fraction of the information available from litterbag experiments is used to develop models. The HPM derives initial decomposition rates of moss plant functional types from litterbag data, but parameters for environmental controls of decomposition are assumptions which appear to be informed at most qualitatively by litterbag experiments, and it is not tested whether the HPM decomposition module successfully fits available litterbag data [@Frolking.2010]. This is also the case for other dynamic peatland models, e.g. @Frolking.2001, @Bauer.2004, @Heijmans.2008, @Heinemeyer.2010, @Morris.2012, @Chaudhary.2018, @Bona.2020.

One reason why such tests have been difficult is that suitable litterbag raw data to test peatland models are scarce. @Bona.2018 developed a Peatland Productivity and Decomposition Parameter Database, but it contains only data from studies older than 2010 and no error estimates for remaining masses in litterbag data. Since decomposition rates have been estimated with different litterbag decomposition models in previous studies, their values are not directly comparable. Moreover, initial leaching losses (losses of soluble compounds, which do not originate from microbial depolymerization, due to leaching during the first days to weeks of incubation) can bias decomposition rate estimates if they are not explicitly considered and can vary between species and experiments [@Yu.2001; @Teickner.2025]. Therefore, raw data (remaining masses) are necessary for any meaningful test of decomposition modules with litterbag data. The recently published Peatland Decomposition Database [@Teickner.2024c] contains raw data from available *Sphagnum* litterbag experiments and therefore allows to estimate parameters with any mass loss-based decomposition model and therefore also allows to consider initial leaching losses.

Even though tests of only a part of a model are less uncertain than tests of whole models, there still is a risk that they are dominated by uncertainties. Remaining masses in litterbag experiments are often very variable, even under controlled environmental conditions [e.g., @Bengtsson.2018], and for many litterbag experiments, a range of decomposition rates may produce similar predictions for remaining masses [e.g., @Yu.2001], also if a litterbag decomposition model compatible with the HPM is used [@Teickner.2025]. Finally, also only five model parameters, as in the case of the HPM decomposition module, can make predictions uncertain. These uncertainties have to be taken into account to check whether litterbag data are compatible with the peatland model. A possible way to do this is to combine the HPM decomposition module, a litterbag decomposition model compatible with this module, and available litterbag experiments into one model and use Bayesian data analysis [@Gelman.2014] to estimate uncertainties of data and parameters.

If such a test suggests that decomposition rates predicted by the HPM decomposition module do not fit estimates from litterbag experiments, or only if parameter estimates of the decomposition module differ from the parameter values originally suggested, even if main uncertainty sources are considered, the test has identified a discrepancy worth considering in more detail. We can then analyze whether previous sensitivity analyses of the HPM suggest that these discrepancies may have larger effects on the predicted C accumulation, and if this is the case, the discrepancies are worth testing in future litterbag experiments.

Our aim is to test the HPM decomposition module against decomposition rates estimated from available *Sphagnum* litterbag experiments. Specifically, we want to:  

1. Test whether the HPM decomposition module can predict litterbag decomposition rates for different *Sphagnum* species along the gradient from oxic to anoxic conditions.

2. Estimate HPM decomposition module parameters from litterbag data and compare them to the originally suggested values (standard parameter values) [@Frolking.2010] that are often used when applying the HPM (Tab. \@ref(tab:hpmd-m-tab-hpm-parameters-standard-values)).

3. If some of the parameter values differ, identify the possible causes why parameter estimates from litterbag data differ to provide guidance for future litterbag experiments.
    
4. Analyze whether estimated differences in HPM parameter values could imply significant differences in decomposition rates and long-term peat accumulation.

To address these aims, we used the HPM decomposition module to predict decomposition rates in available litterbag experiments and compared these to decomposition rates estimated for the same litterbag experiments with a litterbag decomposition model that considers initial leaching losses [@Teickner.2025] (Fig. \@ref(fig:hpmd-m-conceptual)). These predictions require the peat degree of saturation, which we estimate with the modified Granberg model [@Granberg.1999; @Kettridge.2007] from water table depth data reported in these studies. Furthermore, some *Sphagnum* litterbag experiments do not report water table depths and therefore cannot be used to test the HPM, but they still provide information on initial leaching losses and decomposition rates and therefore help to constrain parameter estimates. We therefore include these data via Bayesian hierarchical modeling in the litterbag decomposition model. In summary, our approach combines the HPM decomposition module, the modified Granberg model, and a *Sphagnum* litterbag decomposition model that allows to consider initial leaching losses and to pool information across litterbag experiments <!--model 1-4 in -->[@Teickner.2025]. While this approach has its limitations, it exploits available data as far as possible, while considering known confounders and propagating relevant uncertainties. 

We only test the decomposition module of the HPM, but the decomposition modules of many other peatland models are also parameterized based on litterbag experiments and our modeling approach is flexible enough to be combined with other decomposition modules. Therefore, our test could serve as a blueprint for similar tests of other peatland model decomposition modules. Similarly, the parameter discrepancies identified here suggest future litterbag experiments that would provide novel insights into oxic and anoxic controls of *Sphagnum* decomposition rates and our study therefore suggests a strategy to improve decomposition modules in general. 

(ref:hpmd-m-tab-hpm-parameters-standard-values-caption) Standard values of parameters of the decomposition module in the Holocene Peatland Model [@Frolking.2010].

```{r hpmd-m-tab-hpm-parameters-standard-values, tab.cap='(ref:hpmd-m-tab-hpm-parameters-standard-values-caption)'}
hpmd_get_hpm_standard_parameter_values() |>
  dplyr::mutate(
    variable_pretty =
      dplyr::case_when(
        variable == "m69_p1" ~ "$W_{opt}$ (L$_\\mathrm{water}$ L$_\\mathrm{pores}^{-1}$)",
        variable == "m69_p2" ~ "$c_1$ (-)",
        variable == "m68_p1" ~ "$f_{min}$ (yr$^{-1}$)",
        variable == "m68_p2" ~ "$c_2$ (m)",
        variable == "m68_p3" ~ paste0("$k_{0, \\text{", tolower(hpm_microhabitat), "}}$ (yr$^{-1}$)")
      ),
    description =
      dplyr::case_when(
        variable == "m69_p1" ~ "Optimum degree of saturation for aerobic decomposition.",
        variable == "m69_p2" ~ "Curvature of the relation of the aerobic decomposition rate to the degree of saturation (larger values imply a steeper decrease of decomposition rates for degrees of saturation diverging from $W_{opt}$).",
        variable == "m68_p1" ~ "Minimum anaerobic decomposition rate.",
        variable == "m68_p2" ~ "Anoxia scale length. Represents limitation of anaerobic decomposition rates with increasing distance below the annual average water table depth due to end product accumulation and limitation of available electron acceptors. Larger values mean that anaerobic decomposition rates decrease less strongly with depth below the average annual water table level.",
        variable == "m68_p3" ~ paste0("Maximum possible decomposition rate for ", tolower(hpm_microhabitat), " $Sphagnum$ species.")
      )
  ) |>
  dplyr::select(variable_pretty, value, description) |>
  kableExtra::kable(
    col.names = c("HPM parameter", "Standard value", "Description"), 
    booktabs = TRUE,
    escape = FALSE
  ) %>%
  kableExtra::kable_styling(latex_options = c("hold_position", "scale_down")) |>
  kableExtra::column_spec(3, width = "12cm")
```

\clearpage

(ref:hpmd-m-conceptual-caption) Conceptual representation of the modeling approach. Arrows represent flows of information. Litterbag data that have information on water table depths (WTD) and incubation depths are used to estimate average decomposition rates with the HPM decomposition module ($\mu_k$). The HPM decomposition module needs plant functional type identity, peat degree of saturation, WTD, and incubation depth to predict decomposition rates. The modified Granberg model is used to estimate peat degree of saturation at incubation depths from WTD, minimum water content at the surface, and porosity, of which the latter two are estimated from the remaining masses. The litterbag decomposition model is used to estimate decomposition rates ($k_0$) for all litterbag studies, including those that have information on WTD and those that have not. A gamma distribution with $\mu_k$ as average is used as prior distribution for $k_0$ for the litterbag experiments that have information on WTD (curved arrow). This helps to constrain initial leaching loss and decomposition rate estimates for studies that can be predicted with the HPM decomposition module. The Litterbag decomposition module also estimates initial leaching losses ($l_0$) for all litterbag experiments. The equation at the bottom uses these to estimate remaining masses in the litterbag experiments. The litterbag decomposition model is described in more detail in section \@ref(sdm-003-methods-3). See the text for further details. 
    
```{r hpmd-m-conceptual, out.width="80%", fig.cap='(ref:hpmd-m-conceptual-caption)'}
knitr::include_graphics("figures/eb1125_hpm_decoposition_conceptual.pdf")
```


# Methods {#sdm-003-methods}

```{r res-import}
# model estimates
hpmd_stan_draws_1 <- readRDS_rvars(tar_read(hpmd_stan_draws_1))
hpmd_stan_draws_2 <- readRDS_rvars(tar_read(hpmd_stan_draws_2))
hpmd_stan_draws_3 <- readRDS_rvars(tar_read(hpmd_stan_draws_3))
hpmd_stan_draws_4 <- readRDS_rvars(tar_read(hpmd_stan_draws_4))
hpmd_stan_draws_5 <- readRDS_rvars(tar_read(hpmd_stan_draws_5))
hpmd_stan_draws_9 <- readRDS_rvars(tar_read(hpmd_stan_draws_9))

# model rmse
hpmd_stan_rmse_1 <- readRDS_rvars(tar_read(hpmd_stan_rmse_1))
hpmd_stan_rmse_2 <- readRDS_rvars(tar_read(hpmd_stan_rmse_2))
hpmd_stan_rmse_3 <- readRDS_rvars(tar_read(hpmd_stan_rmse_3))
hpmd_stan_rmse_4 <- readRDS_rvars(tar_read(hpmd_stan_rmse_4))
hpmd_stan_rmse_5 <- readRDS_rvars(tar_read(hpmd_stan_rmse_5))
hpmd_stan_rmse_9 <- readRDS_rvars(tar_read(hpmd_stan_rmse_9))

# for discussion
hpmd_simulation_1_newdata_1 <- readRDS_rvars(tar_read(hpmd_simulation_1_newdata_1))
hpmd_simulation_1_newdata_2 <- readRDS_rvars(tar_read(hpmd_simulation_1_newdata_2))
hpmd_simulation_1_newdata_3 <- readRDS_rvars(tar_read(hpmd_simulation_1_newdata_3))
hpmd_simulation_1_newdata_4 <- readRDS_rvars(tar_read(hpmd_simulation_1_newdata_4))

# get parameter values
hpmd_peat_properties <-
  hpmd_get_peat_properties()

hpmd_hpm_standard_parameter_values <-
  hpmd_get_hpm_standard_parameter_values()

# main data table
tar_load(hpmd_data)
```


## *Sphagnum* litterbag data {#sdm-003-methods-1}

```{r m-peatland-decomposition-database-citation}
hpmd_citations <- 
  hpmd_stan_draws_1 |>
  dplyr::filter(id_citation != "Bengtsson.2017") |>
  dplyr::select(id_citation) |>
  dplyr::mutate(
    id_citation_year =
      id_citation |>
      stringr::str_extract(pattern = "\\d+") |>
      as.integer()
  ) |>
  dplyr::arrange(id_citation_year) |>
  dplyr::pull(id_citation) |>
  unique()

hpmd_citations_index_hpm <- 
  hpmd_stan_draws_1 |>
  dplyr::filter(id_citation != "Bengtsson.2017" & index_hpm) |>
  dplyr::select(id_citation) |>
  dplyr::mutate(
    id_citation_year =
      id_citation |>
      stringr::str_extract(pattern = "\\d+") |>
      as.integer()
  ) |>
  dplyr::arrange(id_citation_year) |>
  dplyr::pull(id_citation) |>
  unique()
```


To test the HPM decomposition module against litterbag data, we used the Peatland Decomposition Database [@Teickner.2024c]. In this study, we use data from  `r paste0("@", hpmd_citations) |> knitr::combine_words()` to estimate $k_0$ using the litterbag decomposition model. Data from `r paste0("@", hpmd_citations_index_hpm) |> knitr::combine_words()` reported WTD and therefore only these data were used to predict $k_0$ also with the HPM decomposition module. Samples originally classified as *Sphagnum magellanicum* are here classified as *Sphagnum magellanicum aggr.* [@Hassel.2018].

(ref:hpmd-m-tab-study-information-caption) Overview on litterbag experiments included for each *Sphagnum* taxon in this study. "HPM microhabitat" is the HPM microhabitat assigned to each taxon. Taxa without value are not considered in @Johnson.2015 (see section \@ref(sdm-003-methods-4)). "Number of experiments" is the number of litterbag experiments available from the Peatland Decomposition Database (these are either individual replicates or average values of replicates, depending on what data were reported in the studies). "Number of experiments with WTD data" is the number of litterbag experiments that also report water table depths and for which we therefore could make predictions with the HPM decomposition module. "Depth range" are the maximum and minimum depth below the peat surface at which litterbags were placed [cm]. Missing values mean that no study reported depths.       
    
```{r hpmd-m-tab-study-information, out.width="80%", tab.cap='(ref:hpmd-m-tab-study-information-caption)', message=FALSE, warning=FALSE}
tar_load(hpmd_data_hpm_microhabitat)

hpmd_stan_draws_1 |>
  dplyr::filter(id_citation != "Bengtsson.2017") |>
  dplyr::filter(! duplicated(id_sample_incubation_start)) |>
  dplyr::group_by(taxon_rank_value) |>
  dplyr::summarise(
    number_studies = length(unique(id_citation)),
    number_experiments = nrow(dplyr::pick(dplyr::everything())),
    number_experiments_with_wtd = sum(! is.na(water_table_depth_to_surface_1)),
    sample_depth_range = 
      {
        if(all(is.na(sample_depth_upper)) || all(is.na(sample_depth_lower))) {
          ""
        } else {
          paste0(range(c(sample_depth_upper, sample_depth_lower), na.rm = TRUE), collapse = ", ")
        }
      },
    .groups = "drop"
  ) |>
  leaching_add_taxon_rank_value_pretty() |>
  dplyr::left_join(
    hpmd_data_hpm_microhabitat |>
      dplyr::select(taxon_rank_value, hpm_microhabitat),
    by = "taxon_rank_value"
  ) |>
  dplyr::mutate(
    taxon_rank_value_pretty = 
      taxon_rank_value_pretty |>
      stringr::str_replace_all("\\*", "$") |>
      stringr::str_replace_all(" ", "~"),
    hpm_microhabitat =
      dplyr::case_when(
        is.na(hpm_microhabitat) ~ "",
        TRUE ~ hpm_microhabitat
      )
  ) |>
  dplyr::select(taxon_rank_value_pretty, hpm_microhabitat, number_studies, number_experiments, number_experiments_with_wtd, sample_depth_range) |>
  kableExtra::kable(
    col.names = c("Taxon", "HPM microhabitat", "Number of studies", "Number of experiments", "Number of experiments with WTD data", "Depth range"), 
    booktabs = TRUE,
    escape = FALSE
  ) %>%
  kableExtra::kable_styling(latex_options = c("hold_position", "scale_down"))
```


## Prediction of litterbag decomposition rates with the Holocene Peatland Model {#sdm-003-methods-2}

To predict decomposition rates, the HPM decomposition module needs as inputs the litter type in terms of the HPM plant functional types (PFT), the fraction of mass already lost due to previous decomposition, the depth of the litter below the peat surface, the water table depth, and the peat degree of saturation [@Frolking.2010].

Predicting decomposition rates for the available litterbag data is not straightforward because the HPM decomposition module does not consider specific features of available litterbag experiments. The HPM does not specify how to assign species to plant functional types. Moreover, none of the available litterbag studies reported the degree of saturation which therefore needs to be estimated in order to make predictions with the HPM decomposition module. The only variables that can be directly linked are the depth of the litter below the peat surface, and water table depths (both reported in litterbag experiments). All other variables can be estimated from available litterbag experiments only with additional assumptions that are described in the following subsections.

In the following subsection, we give a more detailed description of our modeling approach, in particular of the model used to estimate decomposition rates from litterbag data, of the HPM decomposition module and how it predicts decomposition rates, and how we link the decomposition rates estimated from litterbag data to those predicted by the HPM decomposition module. The remaining subsections discuss how we derived or estimated PFT, WTD, and degree of saturation for the litterbag data and additional steps to make the litterbag data compatible with the HPM decomposition module.


### Remaining masses and decomposition rates {#sdm-003-methods-3}

To estimate decomposition rates for available *Sphagnum* litterbag experiments we use the equation from the HPM that computes remaining masses from decomposition rates and decomposition time [@Frolking.2001; @Frolking.2010], with three modifications. The original equation (equation (4) in @Frolking.2001) is:  

\begin{equation}
m(t) = \frac{m_0}{(1 + (1 + \alpha) k_0 t)^{\frac{1}{\alpha - 1}}},
(\#eq:hpm-remaining-mass-original)
\end{equation}

where $m(t)$ is the fraction of initial mass remaining at time $t$, $m_0$ is the fraction of initial mass remaining at time $t=0$, $k_0$ is the decomposition rate, and $\alpha$ is a parameter that describes how decomposition slows down as mass is lost, where the HPM assumes $\alpha = 2$ for simplicity [@Frolking.2001; @Frolking.2010].

The modified version we use here is:

\begin{equation}
\mu_m(t) = \begin{cases}
m_0 & \mathrm{if}~t=0\\
\frac{m_0 - l_0}{(1 + (\alpha - 1) k_0 t)^{\frac{1}{\alpha - 1}}} &     \mathrm{if}~t>0\\
\end{cases}
(\#eq:decomposition-solution-2-with-leaching-1),
\end{equation}

where $l_0$ is the fraction of mass lost due to initial leaching. The HPM decomposition process does not assume that there are initial leaching losses, but these are commonly observed in litterbag experiments and bias decomposition rate estimates when they are ignored [@Yu.2001; @Teickner.2025]; therefore, the modification is necessary to allow a sensible test of the HPM decomposition module with litterbag data.  
The second modification is that we do not assume $\alpha=2$, but consider it as unknown parameter that is estimated from litterbag data. Since $\alpha=2$ was chosen for simplicity and attempts to reliably estimate $\alpha$ have failed [e.g., @Clymo.1998; @Frolking.2001; @Teickner.2025], we estimate $\alpha$ mainly to consider the possible error introduced by this parameter.  
The third modification is that we change $m(t)$ to $\mu_m(t)$ because we assume that equation \@ref(eq:decomposition-solution-2-with-leaching-1) describes only the average fraction of the initial mass remaining. For each retrieved litterbag, we assume that the remaining mass can be described with a beta distribution with precision parameter $\phi_m$:

\begin{equation}
m(t) \sim \text{beta}(\mu_m(t) \phi_m, (1 - \mu_m(t)) \phi_m)
(\#eq:decomposition-solution-2-with-leaching-2),
\end{equation}

Values for $k_0$ are estimated from remaining masses reported in available litterbag experiments conditional on equation \@ref(eq:decomposition-solution-2-with-leaching-1) and a hierarchical prior structure [@Teickner.2025]:

\begin{equation}
k_0 =  \text{exp}(\beta_{k,1} + \beta_{k,2,\text{species}} + \beta_{k,3,\text{species x study}} + \beta_{k,4,\text{sample}}),
(\#eq:model-link-2)
\end{equation}

where $\beta_{k,1}$ is the estimated decomposition rate across all litterbag experiments, $\beta_{k,2,\text{species}}$ describes the difference of the average decomposition rate for the *Sphagnum* species, $\beta_{k,3,\text{species x study}}$ for the study (nested within species), and $\beta_{k,4,\text{sample}}$ for the sample (litterbag experiment). All these parameters have normal distributions as priors. Hierarchical models of the same structure are used to estimate $l_0$ and $\alpha$ from equation \@ref(eq:decomposition-solution-2-with-leaching-1) and to estimate $\phi_m$ from equation \@ref(eq:decomposition-solution-2-with-leaching-2).

These decomposition rates estimated from litterbag experiments are constrained by decomposition rates the HPM decomposition module [@Frolking.2010] predicts for the same litterbag experiments. The HPM decomposition module describes how decomposition rates depend on the *Sphagnum* PFT, the degree of saturation and the depth of a litter sample below the water table. Similar to the remaining mass, we here assume that the HPM decomposition module predicts an average decomposition rate, $\mu_k$, instead of the decomposition rate of individual samples: 

\begin{equation}
\mu_k = \begin{cases}
k_{0,i} f_1(W) & \mathrm{if}~ \hat{z} \le 0\\
k_{0,i} f_2(\hat{z}) & \mathrm{if}~\hat{z}>0
(\#eq:hpm-decomposition-rate-1)
\end{cases}
\end{equation}

where $k_{0,i}$ is the PFT-specific maximum possible decomposition rate (Tab. \@ref(tab:hpmd-m-tab-hpm-parameters-standard-values)), $W$ is the degree of saturation (L$_\text{water}$ L$_\text{sample}^{-1}$), $\hat{z}$ the depth of the sample below the average annual water table ($\hat{z} = z - z_\text{wt}$, where $z_\text{wt}$ and $z$ are the depth of the water table and litterbag below the peat surface), and $f_1$ and $f_2$ are modifiers due to $W$ (under oxic conditions) and $\hat{z}$ (under anoxic conditions), respectively. These modifiers are described in equations (8) and (9) in @Frolking.2010:

\begin{equation}
f_1(W) = 1 - c_1(W - W_{opt})^2
(\#eq:hpm-moisture-modifier-1)
\end{equation}

\begin{equation}
f_2(\hat{z}) = f_{min} + (f_1(1) - f_{min}) \exp \left(\frac{-\hat{z}}{c_2} \right),
(\#eq:hpm-moisture-modifier-2)
\end{equation}

where all not yet mentioned parameters are defined in Tab. \@ref(tab:hpmd-m-tab-hpm-parameters-standard-values).

In our model, $k_0$ estimated from the litterbag data for each litterbag experiment with reported WTD (sample) (equation \@ref(eq:decomposition-solution-2-with-leaching-1)) is assumed to follow a gamma distribution with shape parameter $\alpha_{\mu_k}$ (estimated) and average $\mu_k$ (predicted for each sample with equation \@ref(eq:hpm-decomposition-rate-1)):

\begin{equation}
k_0 \sim \text{gamma}\left(\alpha_{\mu_k}, \frac{\alpha_{\mu_k}}{\mu_k} \right),
(\#eq:model-link-1)
\end{equation}

Thus, the decomposition rate predicted by the HPM decomposition module (equation \@ref(eq:model-link-1)) is a prior for $k_0$ as estimated from the litterbag decomposition model (equation \@ref(eq:model-link-2)). This forms the link between the litterbag decomposition model and the HPM decomposition module (Fig. \@ref(fig:hpmd-m-conceptual)) and also allows us to estimate parameters of the HPM decomposition module from the litterbag data. The advantage of this modeling approach is that we can consider litterbag experiments without water table depth to estimate $l_0$ and $k_0$ for individual *Sphagnum* species, which is additional information to constrain estimates of the HPM decomposition module parameters. Moreover, combining the litterbag decomposition model and the HPM decomposition module into one Bayesian model does not only estimate HPM decomposition module parameters from the litterbag data, but it also adjusts the decomposition rates estimated from litterbag data to the HPM decomposition module because the HPM decomposition module serves as prior in the combined model which therefore estimates what parameter values are compatible with the data and the combined model. This is exactly what we want because there is uncertainty both in the remaining masses reported in litterbag experiments and in HPM decomposition module parameters. If HPM decomposition module parameter estimates from the combined model are different from the standard values used in the original model (Tab. \@ref(tab:hpmd-m-tab-hpm-parameters-standard-values)), even if we consider these uncertainties and use the HPM decomposition module as prior for the litterbag data, this is a discrepancy worth testing in future experiments.

### Assignment of *Sphagnum* species to plant functional types {#sdm-003-methods-4}

The HPM defines maximum possible decomposition rates ($k_{0,i}$) for three *Sphagnum* PFT (hollow, lawn, and hummock species), but not how to assign species to them. We assigned individual *Sphagnum* species to the three PFT by comparing their niche WTD with the optimal WTD for net primary production defined in the HPM. Specifically, we defined fixed average annual WTD intervals for the PFT: hollow (<5 cm), lawn ($\ge5$ cm and $<15$ cm), hummock ($\ge15$ cm) based on the HPM [@Frolking.2010]. Then, we used niche WTD and standard deviations from @Johnson.2015 to assign *Sphagnum* species to these three microhabitats. Using only average values and the microhabitat WTD thresholds resulted in unintuitive assignments, such as assigning *S. fallax* to hummocks. To avoid such obvious misclassifications, we defined rules to assign species to HPM microhabitats based on the probability a species would occur in the three niche WTD intervals. To compute the probabilities, we assumed a normal distribution [@Johnson.2015]:

1. Species with a probability of occurrence $\ge15$% in the intervals of all three PFT were classified as lawn species.

2. In all other cases, species were assigned to the PFT for which their probability of occurrence was largest.  

Litterbag data from @Prevost.1997 are incubations of peat samples where the species is unknown. Based on descriptions in this study, it is likely that the peat was formed by hummock species. Hummock species are assumed to have the smallest decomposition rate among the three *Sphagnum* PFT in the HPM [@Frolking.2010] and this is in line with small decomposition rate estimates for these samples [@Teickner.2025]. For these reasons, we assigned these samples to the hummock PFT of the HPM.

When estimating parameters of the HPM decomposition module from the litterbag data (see section \@ref(sdm-003-methods-8)<!--models 3-3 and 3-4-->), we also estimated the maximum possible decomposition rate ($k_{0,i}$). *Sphagnum* species differ in their decomposition rate and the PFT of the HPM are a simplification that may cause misfits of the HPM decomposition module to litterbag data. We therefore estimated $k_{0,i}$ for individual *Sphagnum* species in models `r hpmd_model_id_to_name_2("3-3")`, `r hpmd_model_id_to_name_2("3-4")`, and `r hpmd_model_id_to_name_2("3-5")` (see section \@ref(sdm-003-methods-8)) and evaluated the variability of these species-specific estimates compared to the standard $k_{0,i}$ values of the HPM *Sphagnum* PFT.    


### Degree of saturation {#sdm-003-methods-5}

We estimated the degree of saturation with the modified Granberg model (ModGberg model) [@Granberg.1999; @Kettridge.2007] from minimum water content at the surface ($\theta_\text{0,min}$), total porosity ($P$), the water table depth below the peat surface ($z_\text{wt}$), and the depth of the litterbags below the peat surface during the incubation ($z$): 

\begin{equation}
\begin{aligned}
\theta(z) & = & \text{min}\left( P, \theta_0 + (P - \theta_0) \left( \frac{z}{z_\text{wt}} \right)^2 \right)\\
\theta_0 & = & \text{max}\left(\theta_\text{0,min}, 0.15 z_\text{wt}^{-0.28}\right),\\
\end{aligned}
(\#eq:hpm-modified-granberg-1)
\end{equation}

where $\theta_0$ is the water content at the surface and $0.15 z_\text{wt}^{-0.28}$ is an empirical relation of $\theta_0$ with the WTD [@Kettridge.2007].    
The minimum water content at the surface was not reported in any study and we therefore assumed a minimum water content at the surface of `r hpmd_peat_properties$minimum_water_content_at_surface_1_average` L$_\text{water}$ L$^{-1}_\text{sample}$ with a standard deviation of `r hpmd_peat_properties$minimum_water_content_at_surface_1_error` L$_\text{water}$ L$^{-1}_\text{sample}$, based on measurements from @Hayward.1982. The total porosity was not reported in any study and therefore we  assumed an average value of `r hpmd_peat_properties$layer_total_porosity_1_average * 100`% with a standard deviation of `r hpmd_peat_properties$layer_total_porosity_1_error * 100`%, roughly based on values reported for low-density *Sphagnum* peat [@Liu.2019]. An improved test of the HPM decomposition module would require litterbag experiments with direct measurements of the degree of saturation at sufficient temporal resolution.


### Fraction of mass lost during previous decomposition {#sdm-003-methods-6}

The HPM decomposition module assumes that decomposition rates decrease the more of the initial mass has already been decomposed [@Frolking.2001; @Frolking.2010]. All litterbag data we use here, except samples from @Prevost.1997, are from *Sphagnum* samples collected from the surface of peatlands and therefore can be expected to have not experienced mass loss due to decomposition at the start of the experiments ($m(t = 0) = 1$ in equation \@ref(eq:decomposition-solution-2-with-leaching-1)). @Prevost.1997 incubated *Sphagnum* peat collected from two different depth levels from the same location and these samples probably had already experienced some decomposition, however it is difficult to estimate how much. To avoid this problem, we estimated $k_{0,i}$ separately for samples from different depths in @Prevost.1997, implicitly assuming that these are two different PFT with different maximum possible decomposition rate.


## Testing the HPM decomposition module against litterbag data {#sdm-003-methods-7}

### Model versions {#sdm-003-methods-8}

To test different aspects of the HPM decomposition module and the additional assumptions we make, we computed several models which differ in whether HPM decomposition module parameters were fixed to their standard values<!--(HPMf)--> or estimated from data<!--(HPMe)-->, whether peat properties (porosity, water table depth, water content, minimum water content at the surface) are estimated from data<!--(HPM-peat)--> or not<!--(HPM)-->, and whether the HPM decomposition module was extended to also predict $l_0$<!--(HPM-l0)--> or not (Tab. \@ref(tab:m-litterbag-synthesis-models)).

The first model (`r hpmd_model_id_to_name_2("3-1")`) does not estimate any parameters of the HPM decomposition module (equations \@ref(eq:hpm-decomposition-rate-1) to \@ref(eq:hpm-moisture-modifier-2)) and does not estimate peat properties from the litterbag data and therefore corresponds to the HPM decomposition module with standard parameter values, while propagating prior uncertainties for peat properties. For this model, predictions of $k_0$ equal $\mu_k$ (equation \@ref(eq:hpm-decomposition-rate-1)). This version of the HPM decomposition module is completely independent of the litterbag decomposition model, meaning that the HPM decomposition module is not used as prior for the litterbag decomposition model (Fig. \@ref(fig:hpmd-m-conceptual)). This also means that to compare $k_0$ predicted by `r hpmd_model_id_to_name_2("3-1")` to $k_0$ estimated from the litterbag decomposition model, we need to estimate the litterbag decomposition model independently, without using the HPM decomposition module as prior. This independent litterbag decomposition model is called LDM-standard (Tab. \@ref(tab:m-litterbag-synthesis-models)). We use LDM-standard not only to compare $k_0$ estimates to $k_0$ predictions of `r hpmd_model_id_to_name_2("3-1")`, but also to analyze how $k_0$ estimates of the litterbag decomposition model changes when we use different versions of the HPM decomposition module as prior in the subsequent models.

Each subsequent model combines the HPM decomposition module and the litterbag decomposition model into one Bayesian model via equation \@ref(eq:model-link-1). Each of these models estimates an additional set of parameters from the litterbag data relative to the previous model (Tab. \@ref(tab:m-litterbag-synthesis-models)). First, only the peat properties (`r hpmd_model_id_to_name_2("3-2")`) are estimated, and second all HPM parameters ($k_{0,i}$, $c_1$, $W_{opt}$, $f_{min}$, $c_2$) (`r hpmd_model_id_to_name_2("3-3")`). Finally, `r hpmd_model_id_to_name_2("3-4")` extends `r hpmd_model_id_to_name_2("3-3")` by adding formulas to model how $l_0$ depends on the degree of saturation, similar to how the HPM decomposition module predicts $k_0$ with equation \@ref(eq:hpm-moisture-modifier-1).

`r hpmd_model_id_to_name_2("3-2")` tested whether the HPM decomposition module can fit available litterbag data when the HPM decomposition module and the litterbag decomposition model are combined and when peat properties are estimated from data.

`r hpmd_model_id_to_name_2("3-3")` estimates what HPM decomposition module parameter values are compatible with available litterbag data and therefore allows to test whether the standard parameter values are extreme relative to these estimates. Values of $k_{0,i}$ were estimated for each species separately, as described in section \@ref(sdm-003-methods-4).

`r hpmd_model_id_to_name_2("3-4")` was computed because decomposition rates estimated from available litterbag experiments are sensitive to initial leaching losses [@Yu.2001; @Lind.2022; @Teickner.2025]. It is therefore interesting to see whether litterbag decomposition rates are estimated differently in `r hpmd_model_id_to_name_2("3-4")` --- when initial leaching losses are constrained by adding formulas to model how $l_0$ depends on the degree of saturation --- compared to `r hpmd_model_id_to_name_2("3-3")` --- when initial leaching loss estimates are constrained only by the litterbag decomposition model. Based on previous experiments with tea bags it is reasonable to assume that there is some relation between initial leaching losses and the degree of saturation [@Lind.2022]. Specifically, we use the following logistic regression model to describe an average initial leaching loss per sample, in dependency of the degree of saturation:

\begin{equation}
\begin{aligned}
\mu_{l} & = & \text{logit}^{-1}(\beta_{l,1} + \beta_{l,2} W)\\
l_0 & \sim & \text{beta}(\mu_{l}\phi_l, (1 - \mu_{l})\phi_l),\\
\end{aligned}
(\#eq:hpm-hpm-l-2)
\end{equation}

where $\mu_{l}$ is the average initial leaching loss for a sample, $\beta_{l,1}$ is the (hypothetical) average initial leaching loss at a degree of saturation 0 for each taxon, $\beta_{l,2}$ is the coefficient that describes the relation to the degree of saturation ($W$), and $\phi_l$ transforms $\mu_{l}$ and $(1 - \mu_{l})$ into the shape and rate parameters of a beta distribution. This beta distribution has the same function as the gamma distribution (equation \@ref(eq:model-link-1)) for $k_0$ (compare also with Fig. \@ref(fig:hpmd-m-conceptual)): it is a prior for $l_0$ estimated with the litterbag decomposition model, where the average of this prior is $\mu_{l}$.

To check whether outliers in the litterbag data could influence our results, we computed one additional model, `r hpmd_model_id_to_name_2("3-5")`, with the same structure as `r hpmd_model_id_to_name_2("3-4")`, but estimated without litterbag experiments identified as outliers. Litterbag experiments were defined as outliers if the reported average remaining mass of any litterbag (batch) during the experiment had a posterior probability $>99$% to be different from the remaining mass predicted by the litterbag decomposition model alone. This procedure identified experiments as outliers where remaining masses increased over time, where litterbags collected at intermediate time points had unexpectedly low remaining masses, or where initial leaching losses were retarded to later time points, presumably because of freezing after the start of the experiment [@Teickner.2025]. In total, `r hpmd_stan_draws_9 |> dplyr::filter(index_hpm & is.na(hpm_k_2_rep) & ! duplicated(id_sample_incubation_start)) |> nrow()` litterbag experiments were identified as outliers. Results for `r hpmd_model_id_to_name_2("3-5")` are shown in supporting information \@ref(si-sup-10) and HPM decomposition module parameter estimates agree with estimates of `r hpmd_model_id_to_name_2("3-4")` and `r hpmd_model_id_to_name_2("3-3")`.

Strictly, we do not test the decomposition module in the HPM, but the combination of the HPM decomposition module and the modified Granberg model, assuming that uncertainties in water table depths are negligible and that we accounted sufficiently for uncertainties in total porosity. This ambiguity has to be accepted when combining heterogeneous litterbag data where some variables have to be estimated. Litterbag experiments where water table depths and the degree of saturation are measured at sufficient temporal resolution are needed to avoid this ambiguity in future studies and to improve any test of the HPM decomposition module.


(ref:frolking2010-indirect) [@Frolking.2010]
(ref:teickner2024f-direct) @Teickner.2025

(ref:eq-decomposition-solution-1-no-leaching-1) \@ref(eq:decomposition-solution-1-no-leaching-1)
(ref:eq-decomposition-solution-1-with-leaching-1) \@ref(eq:decomposition-solution-1-with-leaching-1)
(ref:eq-decomposition-solution-2-no-leaching-1) \@ref(eq:decomposition-solution-2-no-leaching-1)
(ref:eq-decomposition-solution-2-with-leaching-1) \@ref(eq:decomposition-solution-2-with-leaching-1)
(ref:eq-hpm-hpm-l-2) \@ref(eq:hpm-hpm-l-2)
(ref:fig-hpmd-m-conceptual) \@ref(fig:hpmd-m-conceptual)

(ref:m-litterbag-synthesis-models-caption) Overview of HPM decomposition module modifications computed in this study. 

```{r m-litterbag-synthesis-models, tab.cap="(ref:m-litterbag-synthesis-models-caption)"}
dplyr::bind_rows(
  tibble::tibble(
    name_model = "LDM-standard",
    description = "The litterbag decomposition model without the HPM decomposition module as prior. This is model 1-4 from (ref:teickner2024f-direct)."
  ),
  tibble::tibble(
    id_model = c("model 3-1", "model 3-2", "model 3-3", "model 3-4", "model 3-5"),
    name_model = 
      id_model |>
      stringr::str_remove(pattern = "^model ") |>
      hpmd_model_id_to_name_2(),
    description = 
      c(
        "The Holocene Peatland Model decomposition module with standard parameter values (ref:frolking2010-indirect). The model is run with peat water contents estimated with the modified Granberg model, using water table depths and litterbag depths reported from the litterbag studies, and assuming a fixed peat porosity, and minimum peat water content at the surface.", 
        "The same as HPM-standard, but combined with LDM-standard into one Bayesian model, where the HPM decomposition module is a prior for the litterbag decomposition model (Fig. (ref:fig-hpmd-m-conceptual)). Water table depths, peat porosity, and minimum peat water content at the surface are estimated from data.", 
        "The same as HPM-peat, but now also parameters from the HPM decomposition module ($k_{0,i}$, $W_{opt}$, $f_{min}$, $c_1$, $c_2$) are estimated from the litterbag data.", "The same as HPM-all, but now also an average initial leaching loss for each species and, across all species, a factor, by which this average leaching loss increases or decreases as the peat degree of saturation increases, are estimated (equation (ref:eq-hpm-hpm-l-2)).", 
        "The same as HPM-leaching, but computed without litterbag experiments that were identified as outliers (see the text for details)."
        )
  )
) |>
  dplyr::select(-id_model) |>
  kableExtra::kable(
    col.names = c("Model", "Description"), 
    booktabs = TRUE,
    escape = FALSE
  ) %>%
  kableExtra::kable_styling(latex_options = c("hold_position", "scale_down")) |>
  kableExtra::column_spec(2, width = "12cm")
```


### Bayesian data analysis {#sdm-003-methods-13}

```{r}
tar_load(hpmd_stan_checks)
```


All models listed in Tab. \@ref(tab:m-litterbag-synthesis-models) were computed with Bayesian statistics to account for relevant uncertainty sources and include relevant prior knowledge (for example that *Sphagnum* decomposition rates are unlikely to be larger than 0.5 yr$^{-1}$). Bayesian computations were performed using Markov Chain Monte Carlo (MCMC) sampling with Stan (`r rstan::stan_version()`) [@StanDevelopmentTeam.2021a] in R (`r paste(c(R.Version()$major, R.Version()$minor), collapse = ".")`) [@RCoreTeam.2022] via the rstan package (`r packageVersion("rstan")`) [@StanDevelopmentTeam.2021b] using the NUTS sampler [@Hoffman.2014], with four chains, `r leaching_mcmc_config$niter` total iterations per chain, and `r leaching_mcmc_config$nwarmup` warmup iterations per chain. None of the models had divergent transitions`r if(any(hpmd_stan_checks$tables$hpmd_table_mcmc_diagnostics_summary$num_divergent > 0)) "[---todo: check this]"`, the minimum bulk effective sample size was larger than 400`r if(any(hpmd_stan_checks$tables$hpmd_table_mcmc_diagnostics_summary$min_ess_bulk <= 400)) "[---todo: check this]"`, and the largest rank-normalized $\hat{R}$ was `r hpmd_stan_checks$tables$hpmd_table_mcmc_diagnostics_summary |> dplyr::pull(max_rhat_improved) |> max(na.rm = TRUE) |> round(2)`, indicating that all chains converged [@Vehtari.2021]. All models used the same priors for the same parameters and prior choices are listed and justified in supporting Tab. \@ref(si-tab:sup-out-d-sdm-all-models-priors-1). Results of prior and posterior predictive checks are shown in supporting section \@ref(si-sup-3).

We used power-scaling of the prior and likelihood distributions as implemented in the priorsense package (`r packageVersion("priorsense")`) [@Kallioinen.2024] to analyze the relative sensitivity of the posterior distribution to small perturbations of the prior and likelihood in `r hpmd_model_id_to_name_2("3-4")` for HPM decomposition module parameters and peat properties. This is a computationally nonexpensive way to check whether the data provide information about a parameter and where prior and data may provide conflicting information [@Kallioinen.2024]. Results of this analysis and further information on the data analysis are shown in supporting information \@ref(si-sup-12).  



### Fit of model pedictions to estimated decomposition rates and observed remaining masses {#sdm-003-methods-9}

To analyze how well the models fit remaining masses observed in the litterbag experiments, we plotted reported remaining masses versus remaining masses estimated by the litterbag decomposition model in `r hpmd_model_id_to_name_2("3-2")`, `r hpmd_model_id_to_name_2("3-3")`, and `r hpmd_model_id_to_name_2("3-4")`. `r hpmd_model_id_to_name_2("3-1")` is not linked to the litterbag decomposition model and therefore does not predict remaining masses.  

To analyze how well all HPM decomposition module versions fit $k_0$ estimated by the respective litterbag decomposition model, we created a similar plot for $k_0$. Here, we compared predictions of `r hpmd_model_id_to_name_2("3-1")` (equation \@ref(eq:model-link-1)) against estimates of LDM-standard (equation \@ref(eq:model-link-2)). We also computed the average difference of $k_0$ predicted by the HPM decomposition module and estimated from the litterbag data. We then computed the posterior probability that this average difference is different from zero. A large probability indicates a misfit of the model to available litterbag data. We also tested the same difference for specific species because graphical checks indicated that the decomposition rate prediction skill of the HPM decomposition module depends on species. 

To test whether `r hpmd_model_id_to_name_2("3-4")`<!--(model 3-4, section \@ref(sdm-003-methods-8))--> has not only a better fit to available litterbag data, but also a better predictive accuracy for novel data than the model with standard parameter values (`r hpmd_model_id_to_name_2("3-1")`), we compared how well both can predict $k_0$ from litterbag experiments. HPM decomposition module parameters of `r hpmd_model_id_to_name_2("3-1")` are not estimated from data and therefore we could compute the root mean square error of prediction (RMSE$_\text{test}$) directly with $k_0$ predicted by `r hpmd_model_id_to_name_2("3-1")` and estimated with LDM-standard. HPM decomposition module parameters of `r hpmd_model_id_to_name_2("3-4")` are estimated from the litterbag data and we therefore used cross-validation (CV) to estimate RMSE$_\text{test}$. Since decomposition rates from the same species and study usually are not independent, we defined blocks which were used as CV-folds. Each fold represents the data from one study, but only if there were still data for the same *Sphagnum* species left in the remaining data (we want to estimate the predictive accuracy not for new species). Species with data from one study only were always used for model training and not part of the testing folds. This procedure resulted in `r hpmd_data |> dplyr::filter(! duplicated(hpm_cross_validation_id_block) & ! is.na(hpm_cross_validation_id_block)) |> nrow()` folds. `r hpmd_model_id_to_name_2("3-1")` and `r hpmd_model_id_to_name_2("3-4")` were tested against the same data. In the text, RMSE$_\text{train}$ is the RMSE computed with the data a model was estimated with (for `r hpmd_model_id_to_name_2("3-1")`, the data the litterbag decomposition model was estimated with), and RMSE$_\text{test}$ is the RMSE computed with independent test data.


### Changes in $k_0$ and $l_0$ estimates of the litterbag decomposition models compared to LDM-standard

To analyze how parameter values of the litterbag decomposition model change when it is combined with different versions of the HPM decomposition module as prior, we estimated the average difference of $k_0$ and $l_0$ estimates of each model version to $k_0$ and $l_0$ estimates of LDM-standard. In particular, this allowed us to analyze whether there is any change in the relative magnitude of $l_0$ and $k_0$ because the litterbag decomposition module would adjust these parameter values to fit the respective HPM decomposition module prior and still fit the observed remaining masses.


### Magnitudes of $k_0$ along the gradient from oxic to anoxic conditions

To analyze how $k_0$ changes along the gradient from oxic to anoxic conditions, we plotted $k_0$ estimated by LDM-standard versus the water table depth below the litterbags. To this plot, we added $k_0$ predicted by `r hpmd_model_id_to_name_2("3-1")`. To analyze how the relation of $k_0$ changes for the HPM decomposition module modifications compared to `r hpmd_model_id_to_name_2("3-1")`, we computed differences between $k_0$ estimated by `r hpmd_model_id_to_name_2("3-2")`, `r hpmd_model_id_to_name_2("3-3")`, and `r hpmd_model_id_to_name_2("3-4")`, respectively, and `r hpmd_model_id_to_name_2("3-1")`, and plotted these differences versus the water table depth below the litterbags.


### Difference between values of $k_{0,i}$, $c_1$, $W_{opt}$, $c_2$, $f_{min}$ estimated from litterbag data to the standard parameter values

For `r hpmd_model_id_to_name_2("3-3")` and `r hpmd_model_id_to_name_2("3-4")`, we computed the posterior probability that the HPM decomposition module parameter values estimated from litterbag data ($k_{0,i}$, $c_1$, $W_{opt}$, $c_2$, $f_{min}$) differ from the standard parameter values (Tab. \@ref(tab:hpmd-m-tab-hpm-parameters-standard-values)). This way, we could identify discrepancies between standard parameter values and parameter values estimated from available litterbag data.  
For `r hpmd_model_id_to_name_2("3-4")`, we  conducted in addition a sensitivity analysis, where we simulated decomposition of *S. fuscum* incubated at different depths in a peatland with water table depth of `r hpmd_simulation_1_newdata_1 |> dplyr::pull(layer_water_table_depth_to_surface_1) |> unique()` cm below the surface, a porosity of `r hpmd_simulation_1_newdata_1 |> dplyr::pull(layer_total_porosity_1) |> unique()` L$_\text{pores}$ L$_\text{sample}^{-1}$, and a minimum water content at the surface of `r hpmd_simulation_1_newdata_1 |> dplyr::pull(minimum_water_content_at_surface_1) |> unique()` g$_\text{water}$ g$_\text{sample}^{-1}$. With these settings, we predicted five sets of average $k_0$: (1) with `r hpmd_model_id_to_name_2("3-4")` ($k_{0,\text{modified}}(\text{`r hpmd_model_id_to_name_2("3-4")`})$). The remaining four sets were also predicted with `r hpmd_model_id_to_name_2("3-4")`, but each time setting one of the HPM decomposition module parameters to their standard value ($k_{0,\text{standard}}(\text{`r hpmd_model_id_to_name_2("3-4")`})$): (2) $c_1$, (3) $W_{opt}$, (4) $f_{min}$, (5) $c_2$. We then computed the difference of $k_0$ from set (1) and (2) to analyze the effect of the new $c_1$ estimate, from set (1) and (3) to analyze the effect of the new $W_{opt}$ estimate, and so on for sets (4) and (5). This gives the difference in decomposition rates of `r hpmd_model_id_to_name_2("3-4")` if we would set individual HPM decomposition module parameters to their standard values. This way, we could analyze what HPM decomposition module parameters contribute to a change in $k_0$ predictions along the gradient from oxic to anoxic conditions. 


# Results

## Fit and predictive accuracy of the different versions of the HPM decomposition module to available litterbag data

```{r}
a <- 
  tibble::tibble(
  id_fit = 
    hpmd_d_models |>
    dplyr::filter(! (has_cross_validation | prior_only)) |>
    dplyr::pull(id_fit),
  id_model = 
    hpmd_d_models$model_name[hpmd_d_models$id_fit %in% id_fit] |>
    hpmd_model_id_to_name_2(),
  rmse_train_k_2 = 
    c(
      hpmd_stan_rmse_1$rmse_total[[1]], 
      hpmd_stan_rmse_2$rmse_total[[1]],
      hpmd_stan_rmse_3$rmse_total[[1]],
      hpmd_stan_rmse_4$rmse_total[[1]],
      hpmd_stan_rmse_9$rmse_total[[1]]
    ),
  rmse_test_k_2 = 
    dplyr::case_when(
      id_fit == 1 ~ hpmd_stan_rmse_1$rmse_for_cv_folds[[1]],
      id_fit == 4 ~ hpmd_stan_rmse_5$rmse_for_cv_folds[[1]],
      TRUE ~ posterior::as_rvar(NA_real_)
    ),
  n_misfits =
    list(
      hpmd_stan_draws_1, 
      hpmd_stan_draws_2,
      hpmd_stan_draws_3,
      hpmd_stan_draws_4,
      hpmd_stan_draws_9
    ) |>
    purrr::map_int(function(.x) {
      .x |>
        dplyr::filter(! duplicated(id_sample_incubation_start)) |>
        dplyr::mutate(
          is_misfit = Pr(hpm_k_2_rep > k_2) < 0.01 | Pr(hpm_k_2_rep > k_2) > 0.99
        ) |>
        dplyr::pull(is_misfit) |>
        sum(na.rm = TRUE)
    })
) |>
  dplyr::select(-id_fit) |>
  dplyr::mutate(
    dplyr::across(
      ! dplyr::all_of(c("id_model", "n_misfits")),
      function(.x) {
        res <- 
          paste0(
            mean(.x) |> round(3),
            " (", posterior::quantile2(.x, probs = 0.025) |> round(3), ", ",
            posterior::quantile2(.x, probs = 0.975) |> round(3), ")"
          )
        
        res[is.na(.x)] <- ""
        
        res
      }
    )
  )

hpmd_adjustment_of_ldm_estimates_to_hpm_prior <- readRDS_rvars(tar_read(hpmd_adjustment_of_ldm_estimates_to_hpm_prior))

hpmd_adjustment_of_ldm_estimates_to_hpm_prior_species_across_models <- 
  hpmd_adjustment_of_ldm_estimates_to_hpm_prior$res_species |> 
  dplyr::filter(n_samples >= 3) |> 
  dplyr::group_by(taxon_rank_value) |>
  dplyr::summarise(
    dplyr::across(
      dplyr::where(posterior::is_rvar),
      posterior::rvar_mean
    ),
    .groups = "drop"
  )
```


In each model, the litterbag decomposition model fitted the observed remaining masses similarly well (Fig. \@ref(fig:out-p-hpm-mm27-2-mm29-1-mm30-1-p1) (a) and supporting Fig. \@ref(si-fig:sup-hpmd-plot-ppc-posterior-m)), no matter whether the HPM decomposition module was used as prior or not, and whether its parameters were estimated from data (`r hpmd_model_id_to_name_2("3-3")`, `r hpmd_model_id_to_name_2("3-4")`) or not (`r hpmd_model_id_to_name_2("3-2")`). Thus, remaining masses do not indicate large differences between the model versions.

For $k_0$, the picture is more nuanced: When the HPM decomposition module is not used as prior (`r hpmd_model_id_to_name_2("3-1")`), it fitted $k_0$ estimated by the litterbag decomposition model on average less well than when it was used as prior (all other model versions) (Fig. \@ref(fig:out-p-hpm-mm27-2-mm29-1-mm30-1-p1), Tab. \@ref(tab:out-tab-sdm-all-models-rmse-1)). For example, 
`r hpmd_model_id_to_name_2("3-1")` had an average RMSE$_\text{train}$ of  `r hpmd_stan_rmse_1$rmse_total[[1]] |> mean() |> round(digits = 2)` yr$^{-1}$, whereas `r hpmd_model_id_to_name_2("3-4")` had an average RMSE$_\text{train}$ of `r hpmd_stan_rmse_4$rmse_total[[1]] |> mean() |> round(digits = 2)` yr$^{-1}$. However, the cross-validation indicates that when applied to novel samples, both `r hpmd_model_id_to_name_2("3-1")` and `r hpmd_model_id_to_name_2("3-4")` would perform similarly well if one considers the large uncertainty of the RMSE$_\text{test}$ estimates (Tab. \@ref(tab:out-tab-sdm-all-models-rmse-1)).  
Interestingly, all model versions where the HPM decomposition module was used as prior had comparable fits (RMSE$_\text{train}$) (Tab. \@ref(tab:out-tab-sdm-all-models-rmse-1)), even the version that still has standard parameter values for the HPM decomposition module (`r hpmd_model_id_to_name_2("3-2")`). This indicates that a change in HPM decomposition module standard parameter values is not required to make the HPM decomposition module fit $k_0$ values estimated from available litterbag data via the litterbag decomposition model, under the assumptions we made. Instead, the results indicate that parameter values of the litterbag decomposition model can be adjusted to fit predictions of this HPM decomposition module prior.  


<!--In support of this, Fig. \@ref(fig:out-p-hpm-mm27-2-mm29-1-mm30-1-p1) shows that $k_0$ estimates of the litterbag decomposition model without HPM decomposition module as prior (LDM-standard, y-axis values for `r hpmd_model_id_to_name_2("3-1")`) cover a much larger range than $k_0$ estimates the litterbag decomposition model with HPM decomposition module as prior, except for `r hpmd_model_id_to_name_2("3-4")`, where instead predictions of the HPM decomposition module are larger than in all other models.--> 




<!--to variable degrees (Tab. \@ref(tab:out-tab-sdm-all-models-rmse-1)) and prediction errors differed between species. They were particularly small for *S. fuscum* (RMSE$_\text{train}$ = `r hpmd_stan_rmse_1 |> dplyr::filter(taxon_rank_value == "Sphagnum fuscum") |> dplyr::pull(rmse) |> mean() |> round(2)` yr$^{-1} \pm$ `r hpmd_stan_rmse_1 |> dplyr::filter(taxon_rank_value == "Sphagnum fuscum") %>% dplyr::pull(rmse) |> sd() |> round(3)`, data from `r hpmd_stan_rmse_1 |> dplyr::filter(taxon_rank_value == "Sphagnum fuscum") %>% dplyr::pull(list_id_citation) |> unlist() |> length()` studies) as well as *Sphagnum* spec. samples from @Prevost.1997 (RMSE$_\text{train}$ = `r hpmd_stan_rmse_1 |> dplyr::filter(taxon_rank_value == "Sphagnum fuscum") |> dplyr::pull(rmse) |> mean() |> round(2)` yr$^{-1} \pm$ `r hpmd_stan_rmse_1 |> dplyr::filter(taxon_rank_value == "Sphagnum") %>% dplyr::pull(rmse) |> sd() |> round(2)`). All rates were underestimated for *S. angustifolium* (RMSE$_\text{train}$ = `r hpmd_stan_rmse_1 |> dplyr::filter(taxon_rank_value == "Sphagnum angustifolium") |> dplyr::pull(rmse) |> mean() |> round(2)` yr$^{-1} \pm$ `r hpmd_stan_rmse_1 |> dplyr::filter(taxon_rank_value == "Sphagnum angustifolium") |> dplyr::pull(rmse) |> sd() |> round(2)`, data from `r hpmd_stan_rmse_1 |> dplyr::filter(taxon_rank_value == "Sphagnum angustifolium") |> dplyr::pull(list_id_citation) |> unlist() |> length()` studies). All other models had an improved overall fit (smaller average RMSE$_\text{train}$) to the data (Tab. \@ref(tab:out-tab-sdm-all-models-rmse-1), Fig. \@ref(fig:out-p-hpm-mm27-2-mm29-1-mm30-1-p1)). In addition, the litterbag decomposition model of each model version fitted the remaining masses similarly well (supporting Fig. \@ref(si-fig:sup-hpmd-plot-ppc-posterior-m)). However, despite better fitting the data, `r hpmd_model_id_to_name_2("3-4")` did not predict $k_0$ much better in the cross-validation than `r hpmd_model_id_to_name_2("3-1")`, as indicated by a large RMSE$_\text{test}$ estimate with large errors (Tab. \@ref(tab:out-tab-sdm-all-models-rmse-1)). Thus, when the HPM decomposition module is not used as prior for the litterbag decomposition model, estimated $k_0$ do not fit well, but when the HPM decomposition module is used as prior --- even when it still has standard parameter values --- it does fit $k_0$ estimated from the litterbag data better, even though it is unclear from the cross-validation whether this fit is better also for new samples. Importantly, since $k_0$ estimates fitted better even with `r hpmd_model_id_to_name_2("3-2")`, this indicates that no change in HPM decomposition module standard parameter values is required to make the HPM decomposition module compatible with the litterbag data. This in turn indicates that parameter estimates of the litterbag decomposition model ($k_0$ and $l_0$) are adjusted to the HPM prior.--> 

(ref:out-tab-sdm-all-models-rmse-1-caption) Training and testing RMSE for decomposition rates as predicted by different versions of the decomposition module of the Holocene Peatland Model (see Tab. \@ref(tab:m-litterbag-synthesis-models) for a description of the models) and number of misfits. RMSE$_\text{train}(k_0)$ is the root mean square error of model predictions for litterbag replicates used during model computation. RMSE$_\text{test}(k_0)$ is the RMSE for litterbag replicates used in blocked cross-validation. Where no RMSE$_\text{test}(k_0)$ is given, it was not computed for these models. Values are averages and lower and upper bounds of central 95% posterior intervals (yr$^{-1}$). Misfits counts the number of litterbag experiments for which $k_0$ predicted by the HPM decomposition module modification differed from $k_0$ as estimated from the litterbag decomposition model with a posterior probability of at least 99%. In total, $k_0$ was predicted with the HPM decomposition module modifications for `r hpmd_data |> dplyr::filter(index_hpm) |> dplyr::filter(! duplicated(id_sample_incubation_start)) |> nrow()` litterbag experiments (RMSE$_\text{train}(k_0)$) or `r hpmd_data |> dplyr::filter(index_hpm & ! is.na(hpm_cross_validation_id_block)) |> dplyr::filter(! duplicated(id_sample_incubation_start)) |> nrow()` (RMSE$_\text{test}(k_0)$).  


```{r out-tab-sdm-all-models-rmse-1, tab.cap="(ref:out-tab-sdm-all-models-rmse-1-caption)"}
a |>
  kableExtra::kable(
    col.names = c("Model", "RMSE$_\\text{train}(k_0)$", "RMSE$_\\text{test}(k_0)$", "Misfits"), 
    booktabs = TRUE,
    escape = FALSE
  ) |>
  kableExtra::kable_styling(latex_options = c("hold_position"))
```

\clearpage

(ref:out-p-hpm-mm27-2-mm29-1-mm30-1-p1-caption) (a) Measured remaining masses versus remaining masses predicted by the litterbag decomposition model combined with each HPM decomposition module version. Values are shown for litterbag experiments with reported water table data. For `r hpmd_model_id_to_name_2("3-1")` no values are shown because it was not combined with a litterbag decomposition model. (b) $k_0$ estimated by the litterbag decomposition model versus $k_0$ predicted by different modifications of the HPM decomposition module (Tab. \@ref(tab:m-litterbag-synthesis-models)). For `r hpmd_model_id_to_name_2("3-1")`, y-axis values are $k_0$ estimates of LDM-standard. For all other model versions, y-axis values are $k_0$ estimates of the litterbag decomposition module with the respective HPM decomposition module version as prior. Points represent average estimates and error bars 95% posterior intervals. Points are colored according to the microhabitat classification of *Sphagnum species* (see the Methods section for details). In (b), error bars exceeding 0.5 yr$^{-1}$ are clipped. 


```{r out-p-hpm-mm27-2-mm29-1-mm30-1-p1, fig.cap='(ref:out-p-hpm-mm27-2-mm29-1-mm30-1-p1-caption)', out.width="100%"}
knitr::include_graphics(tar_read(hpmd_plot_1))
```


## How are parameter values of the litterbag decomposition model adjusted when different versions of the HPM decomposition module are used as prior?

To understand how using the HPM decomposition module as prior changes $k_0$ and $l_0$ estimates of the litterbag decomposition model, we compared $k_0$ and $l_0$ estimates of the litterbag decomposition model of each model version with the $k_0$ and $l_0$ estimates of LDM-standard. We computed the average difference of $k_0$ estimates by the litterbag decomposition model for all models compared to the $k_0$ estimates of LDM-standard (using only litterbag experiments with reported WTD). Average differences compared to LDM-standard are in the order `r hpmd_adjustment_of_ldm_estimates_to_hpm_prior$res_total |> dplyr::arrange(mean(k_2_md)) |> dplyr::pull(id_model) |> paste(collapse = " < ")` (average and 95% confidence interval: `r hpmd_adjustment_of_ldm_estimates_to_hpm_prior$res_total |> dplyr::arrange(mean(k_2_md)) |> dplyr::pull(k_2_md) |> purrr::map_chr(function(.x) {paste0(round(mean(.x), 2), " (", round(posterior::quantile2(.x, probs = 0.025), 2), ", ", round(posterior::quantile2(.x, probs = 0.975), 2), ")")}) |> paste(collapse = " < ")` yr$^{-1}$). The magnitude (mean absolute difference) of adjustments of $k_0$ estimates is different for different species (species with at least 3 samples): The largest average  absolute differences across all models were made for `r hpmd_adjustment_of_ldm_estimates_to_hpm_prior_species_across_models |> dplyr::arrange(mean(k_2_mad)) |> dplyr::slice_tail(n = 1) |> leaching_add_taxon_rank_value_pretty() |> dplyr::pull(taxon_rank_value_pretty)` (`r hpmd_adjustment_of_ldm_estimates_to_hpm_prior_species_across_models |> dplyr::arrange(mean(k_2_mad)) |> dplyr::slice_tail(n = 1) |> dplyr::pull(k_2_mad) |> purrr::map_chr(function(.x) {paste0(round(mean(.x), 2), " (", round(posterior::quantile2(.x, probs = 0.025), 2), ", ", round(posterior::quantile2(.x, probs = 0.975), 2), ")")})` yr$^{-1}$) and the smallest for `r hpmd_adjustment_of_ldm_estimates_to_hpm_prior_species_across_models |> dplyr::arrange(mean(k_2_mad)) |> dplyr::slice_head(n = 1) |> leaching_add_taxon_rank_value_pretty() |> dplyr::pull(taxon_rank_value_pretty)` (`r hpmd_adjustment_of_ldm_estimates_to_hpm_prior_species_across_models |> dplyr::arrange(mean(k_2_mad)) |> dplyr::slice_head(n = 1) |> dplyr::pull(k_2_mad) |> purrr::map_chr(function(.x) {paste0(round(mean(.x), 2), " (", round(posterior::quantile2(.x, probs = 0.025), 2), ", ", round(posterior::quantile2(.x, probs = 0.975), 2), ")")})` yr$^{-1}$). This indicates that for some species $k_0$ estimates of the litterbag decomposition model are forced to smaller values for `r hpmd_model_id_to_name_2("3-2")` and `r hpmd_model_id_to_name_2("3-3")`, whereas differences are smaller for `r hpmd_model_id_to_name_2("3-4")`.  
With these changes in $k_0$ estimates, a similar fit to remaining masses as observed for all models (see the previous subsection) is only possible when $l_0$ estimates are changed in the opposite direction. To check this, we computed the average difference of $l_0$ estimates by the litterbag decomposition model for all model versions compared to the $l_0$ estimates of LDM-standard. Differences compared to LDM-standard are in the order `r hpmd_adjustment_of_ldm_estimates_to_hpm_prior$res_total |> dplyr::arrange(mean(l_2_md)) |> dplyr::pull(id_model) |> paste(collapse = " < ")` (average and 95% confidence interval: `r hpmd_adjustment_of_ldm_estimates_to_hpm_prior$res_total |> dplyr::arrange(mean(l_2_md)) |> dplyr::pull(l_2_md) |> magrittr::multiply_by(100) |> purrr::map_chr(function(.x) {paste0(round(mean(.x), 1), " (", round(posterior::quantile2(.x, probs = 0.025), 1), ", ", round(posterior::quantile2(.x, probs = 0.975), 1), ")")}) |> paste(collapse = " < ")` mass %). Again, the magnitude (mean absolute difference) of adjustments of $l_0$ estimates is different for different species (species with at least 3 samples): The largest average  absolute differences across all models were made for `r hpmd_adjustment_of_ldm_estimates_to_hpm_prior_species_across_models |> dplyr::arrange(mean(l_2_mad)) |> dplyr::slice_tail(n = 1) |> leaching_add_taxon_rank_value_pretty() |> dplyr::pull(taxon_rank_value_pretty)` (`r hpmd_adjustment_of_ldm_estimates_to_hpm_prior_species_across_models |> dplyr::arrange(mean(k_2_mad)) |> dplyr::slice_tail(n = 1) |> dplyr::pull(l_2_mad) |> magrittr::multiply_by(100) |> purrr::map_chr(function(.x) {paste0(round(mean(.x), 1), " (", round(posterior::quantile2(.x, probs = 0.025), 1), ", ", round(posterior::quantile2(.x, probs = 0.975), 1), ")")})` mass %) and the smallest for `r hpmd_adjustment_of_ldm_estimates_to_hpm_prior_species_across_models |> dplyr::arrange(mean(l_2_mad)) |> dplyr::slice_head(n = 1) |> leaching_add_taxon_rank_value_pretty() |> dplyr::pull(taxon_rank_value_pretty)` (`r hpmd_adjustment_of_ldm_estimates_to_hpm_prior_species_across_models |> dplyr::arrange(mean(l_2_mad)) |> dplyr::slice_head(n = 1) |> dplyr::pull(l_2_mad) |> magrittr::multiply_by(100) |> purrr::map_chr(function(.x) {paste0(round(mean(.x), 2), " (", round(posterior::quantile2(.x, probs = 0.025), 2), ", ", round(posterior::quantile2(.x, probs = 0.975), 2), ")")})` mass %). Thus, the smaller $k_0$ estimates are indeed compensated by larger $l_0$ estimates for `r hpmd_model_id_to_name_2("3-2")` and `r hpmd_model_id_to_name_2("3-3")`, whereas the difference to LDM-standard is smaller for  `r hpmd_model_id_to_name_2("3-4")`.  
Overall, this analysis indicates that errors in remaining masses observed in available litterbag experiments are large enough to support a range of $k_0$ and $l_0$ estimates. The equivalent fit of the different model versions is therefore caused by adjusting $k_0$ to the HPM prior, and adjusting $l_0$ as needed to fit observed masses.







<!--For `r hpmd_model_id_to_name_2("3-2")` and `r hpmd_model_id_to_name_2("3-3")`, the litterbag decomposition module estimates smaller $k_0$ and larger $l_0$ compared to LDM-standard. Thus, when the HPM decomposition module enforces small $k_0$ values, the respective litterbag decomposition module increases initial leaching losses ($l_0$) to be able to fit the remaining masses observed in the litterbag experiments. However, when in addition $l_0$ estimates are constrained by a separate model with the degree of saturation (`r hpmd_model_id_to_name_2("3-4")`), $k_0$ and $l_0$ estimates are more similar to the estimates of LDM-standard. In this case, the HPM decomposition module prior is forced to predict larger $k_0$ since small $k_0$ and smaller $l_0$ would otherwise underestimate remaining masses. In summary, this indicates that standard parameter values of the HPM decomposition module are compatible with litterbag data only if $l_0$ are larger than estimated by LDM-standard, partly exceeding 20 mass % (Fig. \@ref(fig:out-sdm-all-models-p2)).

(ref:out-sdm-all-models-p2-caption) Plot of $l_0$ (a) or $k_0$ (b) as predicted by the litterbag decomposition model with different modifications of the HPM decomposition module as prior versus estimates of LDM-standard for the same data (i.e., without using any version of the HPM decomposition module as prior) (see Tab. \@ref(tab:m-litterbag-synthesis-models)). Litterbag experiments for which the HPM decomposition module could make predictions (water table depths reported in the studies) and with which the HPM decomposition module parameters were estimated are shown as white points. Points represent average estimates and error bars 95% posterior intervals. Estimates for experiments from @Hagemann.2015 are not shown because these always had large estimates for $k_0$ and would make it difficult to recognize the other points. @Hagemann.2015 do not report water table depths and therefore the respective $k_0$ estimates do not have the HPM decomposition module as prior in any model version.--> 

```{r out-sdm-all-models-p2, fig.cap='(ref:out-sdm-all-models-p2-caption)', out.width="100%", eval=FALSE}
knitr::include_graphics(tar_read(hpmd_plot_3))
```


## How do HPM decomposition module parameter estimates differ to the standard values?

```{r}
hpmd_stan_draws_3_k0i <-  
  hpmd_stan_draws_3 %>%
  dplyr::filter(index_hpm) %>%
  dplyr::filter(! duplicated(taxon_rank_value)) %>%
  leaching_add_taxon_rank_value_pretty() %>%
  dplyr::select(taxon_rank_value, taxon_rank_value_pretty, hpm_microhabitat, m68_p3_2) %>%
  dplyr::left_join(
    hpmd_hpm_standard_parameter_values %>%
      dplyr::filter(! is.na(hpm_microhabitat) & variable == "m68_p3") %>%
      dplyr::select(hpm_microhabitat, value) %>%
      dplyr::rename(
        k0 = "value"
      ),
    by = "hpm_microhabitat"
  )

hpmd_stan_draws_4_k0i <-  
  hpmd_stan_draws_4 %>%
  dplyr::filter(index_hpm) %>%
  dplyr::filter(! duplicated(taxon_rank_value)) %>%
  leaching_add_taxon_rank_value_pretty() %>%
  dplyr::select(taxon_rank_value, taxon_rank_value_pretty, hpm_microhabitat, m68_p3_2) %>%
  dplyr::left_join(
    hpmd_hpm_standard_parameter_values %>%
      dplyr::filter(! is.na(hpm_microhabitat) & variable == "m68_p3") %>%
      dplyr::select(hpm_microhabitat, value) %>%
      dplyr::rename(
        k0 = "value"
      ),
    by = "hpm_microhabitat"
  )
```

Two model versions estimated HPM decomposition module parameters ($c_1$, $W_{opt}$, $f_{min}$, $c_2$, $k_{0,i}$): `r hpmd_model_id_to_name_2("3-3")` and `r hpmd_model_id_to_name_2("3-4")`. These models indicate larger values for $c_2$ and $W_{opt}$ than the standard values. Figure \@ref(fig:out-mm30-hpm-test-p2) shows marginal posterior densities of the HPM decomposition module parameters for `r hpmd_model_id_to_name_2("3-3")`, with standard parameter values as defined in @Frolking.2010 indicated by vertical lines. For both `r hpmd_model_id_to_name_2("3-3")` and `r hpmd_model_id_to_name_2("3-4")`, there are large posterior probabilities that $c_2$ ($P_\text{`r hpmd_model_id_to_name_2("3-3")`}(c_2>`r hpmd_hpm_standard_parameter_values |> dplyr::filter(variable == "m68_p2") |> dplyr::pull(value)`~\mathrm{m}) = `r hpmd_stan_draws_3 |> dplyr::filter(index_hpm) |> dplyr::slice(1) |> dplyr::mutate(res = posterior::Pr(m68_p2 > ( hpmd_hpm_standard_parameter_values |> dplyr::filter(variable == "m68_p2") |> dplyr::pull(value)))) |> dplyr::pull(res) |> round(2)`$ and $P_\text{`r hpmd_model_id_to_name_2("3-4")`}(c_2>`r hpmd_hpm_standard_parameter_values |> dplyr::filter(variable == "m68_p2") |> dplyr::pull(value)`~\mathrm{m}) = `r hpmd_stan_draws_4 |> dplyr::filter(index_hpm) |> dplyr::slice(1) |> dplyr::mutate(res = posterior::Pr(m68_p2 > ( hpmd_hpm_standard_parameter_values |> dplyr::filter(variable == "m68_p2") |> dplyr::pull(value)))) |> dplyr::pull(res) |> round(2)`$) and $W_{opt}$ ($P_\text{`r hpmd_model_id_to_name_2("3-3")`}(W_{opt}>`r hpmd_hpm_standard_parameter_values |> dplyr::filter(variable == "m69_p1") |> dplyr::pull(value)`~\mathrm{L}_\mathrm{water}~\mathrm{L}_\mathrm{pores}^{-1}) = `r hpmd_stan_draws_3 |> dplyr::filter(index_hpm) |> dplyr::slice(1) |> dplyr::mutate(res = posterior::Pr(m69_p1 > (hpmd_hpm_standard_parameter_values |> dplyr::filter(variable == "m69_p1") |> dplyr::pull(value)))) |> dplyr::pull(res) |> round(2)`$ and $P_\text{`r hpmd_model_id_to_name_2("3-4")`}(W_{opt}>`r hpmd_hpm_standard_parameter_values |> dplyr::filter(variable == "m69_p1") |> dplyr::pull(value)`~\mathrm{L}_\mathrm{water}~\mathrm{L}_\mathrm{pores}^{-1}) = `r hpmd_stan_draws_4 |> dplyr::filter(index_hpm) |> dplyr::slice(1) |> dplyr::mutate(res = posterior::Pr(m69_p1 > (hpmd_hpm_standard_parameter_values |> dplyr::filter(variable == "m69_p1") |> dplyr::pull(value)))) |> dplyr::pull(res) |> round(2)`$) have larger values than the standard parameter values, indicating a discrepancy between the HPM decomposition module and available litterbag data (Fig. \@ref(fig:out-mm30-hpm-test-p2) and supporting Fig. \@ref(si-fig:sup-hpmd-plot-4-4)). In contrast, estimates for $f_{min}$ do not differ much to the prior value and the power-scaling sensitivity analysis indicates a weak influence of the data (supporting information \@ref(si-sup-12)) and therefore that currently available litterbag data provide only little information about minimum decomposition rates under anoxic conditions. `r hpmd_model_id_to_name_2("3-3")` and `r hpmd_model_id_to_name_2("3-4")` suggest a large variability of $k_{0,i}$ for individual species: Both models estimate a large posterior probability ($>95$%) that `r dplyr::intersect(hpmd_stan_draws_3_k0i |> dplyr::filter(Pr(m68_p3_2 > k0) > 0.95) |> dplyr::pull(taxon_rank_value_pretty) |> unique(), hpmd_stan_draws_4_k0i |> dplyr::filter(Pr(m68_p3_2 > k0) > 0.95) |> dplyr::pull(taxon_rank_value_pretty) |> unique()) |> knitr::combine_words()` have a larger, and that  `r dplyr::intersect(hpmd_stan_draws_3_k0i |> dplyr::filter(Pr(m68_p3_2 < k0) > 0.95) |> dplyr::pull(taxon_rank_value_pretty) |> unique(), hpmd_stan_draws_4_k0i |> dplyr::filter(Pr(m68_p3_2 < k0) > 0.95) |> dplyr::pull(taxon_rank_value_pretty) |> unique()) |> knitr::combine_words()` has a smaller maximum possible decomposition rate ($k_{0,i}$) than the standard values for the respective PFT (Fig. \@ref(fig:out-mm30-hpm-test-p2) (b) and supporting Fig. \@ref(si-fig:sup-hpmd-plot-4-4)). However, estimates for $k_{0,i}$ were very variable for the same species when different subsets of the litterbag data were used to estimate the model in the cross-validation. This indicates that samples of the same species from different studies have a large variability in $k_{0,i}$ values. In summary, when HPM decomposition module parameters are estimated from available litterbag data, estimates for $W_{opt}$ and $c_2$ are larger than the standard values, differences to the $c_1$ and $f_{min}$ standard value cannot be detected, and estimates for $k_{0,i}$ are variable and have large errors for different species. 

(ref:out-mm30-hpm-test-p2-caption) Marginal posterior distributions of HPM decomposition module parameters (see Tab. \@ref(tab:hpmd-m-tab-hpm-parameters-standard-values)) as estimated by `r hpmd_model_id_to_name_2("3-3")`. (a) Marginal posterior distributions for $c_1$, $W_{opt}$, $f_{min}$, and $c_2$. (b) Marginal posterior distributions for $k_{0,i}$ (maximum possible decomposition rate for species $i$). Species were assigned to HPM microhabitats as described in section 2.2.2. Vertical black lines are the standard parameter values from @Frolking.2010. *Sphagnum* spec. are samples that have been identified only to the genus level.

```{r out-mm30-hpm-test-p2, fig.cap='(ref:out-mm30-hpm-test-p2-caption)', out.width="100%"}
knitr::include_graphics(tar_read(hpmd_plot_4_3))
```


## Magnitude and change of decomposition rates along the gradient from oxic to anoxic conditions

A comparison of $k_0$ estimates of LDM-standard and $k_0$ estimates of `r hpmd_model_id_to_name_2("3-1")` shows that the HPM decomposition module with standard parameter values implies a steeper decrease of decomposition rates from oxic to anoxic conditions than LDM-standard and, for some species, smaller anaerobic decomposition rates. Figure  \@ref(fig:out-p-hpm-mm27-2-mm29-1-mm30-1-p2) (a) shows $k_0$ estimated by LDM-standard and $k_0$ predicted by `r hpmd_model_id_to_name_2("3-1")` versus water table depths below the litterbags reported in the studies for species with at least three litterbag experiments. Regression lines were fitted to both sets of $k_0$ values and they indicate an on average steeper slope for `r hpmd_model_id_to_name_2("3-1")` than for LDM-standard for many species (with large uncertainties). Moreover, under anoxic conditions (negative water table depth), $k_0$ estimates by LDM-standard are larger on average for many of the litterbag experiments than what `r hpmd_model_id_to_name_2("3-1")` predicts (Fig. \@ref(fig:out-p-hpm-mm27-2-mm29-1-mm30-1-p2) (b)).  

(ref:out-p-hpm-mm27-2-mm29-1-mm30-1-p2-caption) Comparison of $k_0$ estimates of `r hpmd_model_id_to_name_2("3-1")` and LDM-standard (Tab. \@ref(tab:m-litterbag-synthesis-models)) for species with at least three litterbag experiments. (a) $k_0$ estimates of `r hpmd_model_id_to_name_2("3-1")` (grey) and $k_0$ estimates of LDM-standard (black) versus reported average water table depths below the litterbags (negative values represent litterbags placed below the water table, positive values represent litterbags placed above the water table in the unsaturated zone). (b) $k_0$ estimates of LDM-standard minus $k_0$ estimates of `r hpmd_model_id_to_name_2("3-1")` versus reported average water table depths below the litterbags (i.e., the difference of the values shown in (a)). Grey horizontal lines indicate a difference in $k_0$ of 0 yr$^{-1}$. Points represent average estimates and error bars 95% posterior intervals. Lines are predictions of linear models fitted to the average estimates. *Sphagnum* spec. are samples that have been identified only to the genus level.


<!--$k_0$ estimated from the litterbag data (Predicted with HPM = No) and predicted by different versions of the HPM decomposition module (Predicted with HPM = Yes) (`r hpmd_model_id_to_name_2("3-1")`, `r hpmd_model_id_to_name_2("3-2")`, `r hpmd_model_id_to_name_2("3-3")`, or `r hpmd_model_id_to_name_2("3-4")`) versus reported (`r hpmd_model_id_to_name_2("3-1")`) or estimated (`r hpmd_model_id_to_name_2("3-2")`, `r hpmd_model_id_to_name_2("3-3")`, or `r hpmd_model_id_to_name_2("3-4")`) average water table depths below the litterbags (negative values represent litterbags placed below the water table, positive values represent litterbags placed above the water table in the unsaturated zone). Points represent average estimates and error bars 95% posterior intervals. Lines are predictions of linear models fitted to the average estimates. *Sphagnum* spec. are samples that have been identified only to the genus level. Only data for species with at least three replicates are shown.-->


```{r out-p-hpm-mm27-2-mm29-1-mm30-1-p2, fig.cap='(ref:out-p-hpm-mm27-2-mm29-1-mm30-1-p2-caption)', out.width="70%"}
knitr::include_graphics(tar_read(hpmd_plot_10))
```


A comparison of $k_0$ estimates of `r hpmd_model_id_to_name_2("3-1")` and the other modifications of the HPM decomposition module suggests that when HPM decomposition module parameters are estimated, larger anaerobic decomposition rates and a less steep decrease of decomposition rates from oxic to anoxic conditions are predicted, similar to LDM-standard. We computed the difference of $k_0$ predicted by `r hpmd_model_id_to_name_2("3-1")` and the other HPM decomposition module versions (Fig. \@ref(fig:out-p-hpmd-plot-9)). When the HPM decomposition module with standard parameter values is used as prior for the litterbag decomposition module (`r hpmd_model_id_to_name_2("3-2")`), it predicts $k_0$ nearly identical to `r hpmd_model_id_to_name_2("3-1")`. In contrast, both model versions where HPM decomposition module parameters were estimated predict larger anaerobic decomposition rates and less of an increase under oxic conditions relative to anoxic conditions than `r hpmd_model_id_to_name_2("3-1")`. Thus, the HPM decomposition module with standard parameter values predicts a steeper decrease of decomposition rates from oxic to anoxic conditions and overall smaller anaerobic decomposition rates than LDM-standard and the models that estimate HPM decomposition module parameters from available litterbag data.

(ref:out-p-hpmd-plot-9-caption) $k_0$ predicted by HPM decomposition module modifications (either `r hpmd_model_id_to_name_2("3-2")`, `r hpmd_model_id_to_name_2("3-3")`, or `r hpmd_model_id_to_name_2("3-4")`) minus $k_0$ predicted by the HPM decomposition module with standard parameter values (`r hpmd_model_id_to_name_2("3-1")`) versus estimated average water table depths below the litterbags (negative values represent litterbags placed below the water table, positive values represent litterbags placed above the water table in the unsaturated zone). Points represent average estimates and error bars 95% posterior intervals. *Sphagnum* spec. are samples which that been identified only to the genus level. Only data for species with at least three replicates are shown.

```{r out-p-hpmd-plot-9, fig.cap='(ref:out-p-hpmd-plot-9-caption)', out.width="90%"}
knitr::include_graphics(tar_read(hpmd_plot_9))
```


## HPM decomposition module parameters that are responsible for the less steep gradient in decomposition rates from oxic to anoxic conditions

To analyze which of the HPM decomposition module parameters ($c_1$, $W_{opt}$, $f_{min}$, $c_2$) cause the less steep gradient in decomposition rates from oxic to anoxic conditions, we conducted a sensitivity analysis, where we made predictions with `r hpmd_model_id_to_name_2("3-4")` for the same species and the same gradient from oxic to anoxic conditions, each time setting one of the four parameters to their standard values (four sets of predictions in total). We then computed the difference of the predicted $k_0$ values to predictions of `r hpmd_model_id_to_name_2("3-4")` (with no parameter value set to its standard value). This difference is plotted versus the depth of the water table below the litter, as shown in Fig. \@ref(fig:out-sdm-parameters-standard-vs-estimated-p1). This analysis suggests that $W_{opt}$ and $c_2$ cause the less steep gradient in decomposition rates from oxic to anoxic conditions, whereas the other two parameters have no qualitative influence.

(ref:out-sdm-parameters-standard-vs-estimated-p1-caption) Difference between decomposition rates for *S. fuscum* predicted with parameter values estimated by `r hpmd_model_id_to_name_2("3-4")` ($k_{0,\text{modified}}(\text{`r hpmd_model_id_to_name_2("3-4")`})$), and when setting the HPM decomposition module parameter in the panel title to its standard value ($k_{0,\text{standard}}(\text{`r hpmd_model_id_to_name_2("3-4")`})$), versus the water table depth below the litter (negative values represent litter placed below the water table, positive values represent litter placed above the water table in the unsaturated zone). Panels show results when different parameters are set to their standard values. Positive $k_{0,\text{modified}}(\text{`r hpmd_model_id_to_name_2("3-4")`}) - k_{0,\text{standard}}(\text{`r hpmd_model_id_to_name_2("3-4")`})$ means that decomposition rates are larger when using the estimated parameter value compared to using the standard parameter value. Shaded areas are central confidence intervals with probabilities given in the  figure legend.     

```{r out-sdm-parameters-standard-vs-estimated-p1, fig.cap='(ref:out-sdm-parameters-standard-vs-estimated-p1-caption)', out.width="100%"}
knitr::include_graphics(tar_read(hpmd_simulation_1_plot_1))
```


## Relation of $l_0$ to the degree of saturation

In model `r hpmd_model_id_to_name_2("3-4")`, we included a logistic regression model that estimates the relation between $l_0$ and the degree of saturation. The parameter estimates suggest that both positive and negative relations of $l_0$ to the degree of saturation are compatible with available litterbag data (95% confidence intervals for the slope (logit scale): (`r hpmd_stan_fit_4 |> tidybayes::spread_rvars(hpm_l_2_p3) |> dplyr::mutate(hpm_l_2_p3 = hpm_l_2_p3 * hpmd_data_stan_4$hpm_l_2_p3_p2 + hpmd_data_stan_4$hpm_l_2_p3_p1) |> dplyr::pull(hpm_l_2_p3) |> posterior::quantile2() |> round(2) |> knitr::combine_words(and = ", ")`)). Thus, available litterbag data do not allow to conclude whether $l_0$ are positively related to the degree of saturation or not. 





<!--## Relation between $k_0$ estimates from the HPM decomposition modules and the respective litterbag decomposition models

The improved fit of $k_0$ estimates from the HPM decomposition module with the litterbag decomposition model in each model combination other than `r hpmd_model_id_to_name_2("3-1")` mentioned in the previous subsection is mainly caused by adjusting $k_0$ estimates of the litterbag decomposition model to the HPM decomposition module prior. This is illustrated in Fig. \@ref(fig:out-p-hpm-mm27-2-mm29-1-mm30-1-p1), where we plotted $k_0$ estimated by the litterbag decomposition model and the HPM decomposition module for each model version versus the water table depth, for all species with sufficient data. Only for `r hpmd_model_id_to_name_2("3-1")`, where the HPM decomposition module is not used as prior, do estimates of the litterbag decomposition model and the HPM decomposition module differ. For all other model versions, estimates by the HPM decomposition module are more similar to those of the standard HPM decomposition module (`r hpmd_model_id_to_name_2("3-1")`) and $k_0$ estimates of the litterbag decomposition model are much lower now, compared to `r hpmd_model_id_to_name_2("3-1")`. The only exception here is `r hpmd_model_id_to_name_2("3-4")`, where estimates of the HPM decomposition module are again somewhat larger for some species and more similar to those of the litterbag decomposition module alone. Thus, the improved fit of $k_0$ estimates from these HPM decomposition module versions to the litterbag decomposition model $k_0$ estimates is caused by adjusting the litterbag decomposition model $k_0$ estimates to the HPM decomposition module; for `r hpmd_model_id_to_name_2("3-4")` this adjustment is somewhat weaker.-->         



<!--## Relation of $k_0$ and $l_0$ estimates of the litterbag decomposition model with and without different HPM decomposition module as prior

To better understand how the litterbag decomposition model $k_0$ estimates can be adjusted to the respective HPM decomposition module prior, we plotted $k_0$ and $l_0$ estimates of the litterbag decomposition model of each combined model versus the estimates of the litterbag decomposition model without HPM decomposition module prior (`r hpmd_model_id_to_name_2("3-1")`) (Fig. \@ref(fig:out-p-hpm-mm27-2-mm29-1-mm30-1-p2)). As expected based on the previous subsection, $k_0$ estimates for `r hpmd_model_id_to_name_2("3-2")` and `r hpmd_model_id_to_name_2("3-3")` are smaller than for `r hpmd_model_id_to_name_2("3-1")` because the $k_0$ estimates are adjusted to the HPM decomposition module prior for these two models. In contrast, for `r hpmd_model_id_to_name_2("3-4")`, estimates are much more similar to when the HPM decomposition module is not used as prior. At the same time, the differences in $l_0$ estimates are inverse to those for $k_0$: For `r hpmd_model_id_to_name_2("3-2")` and `r hpmd_model_id_to_name_2("3-3")`, $l_0$ estimates are much larger for samples that are affected by the HPM prior, whereas $l_0$ estimates of the litterbag decomposition model in `r hpmd_model_id_to_name_2("3-4")` are much more similar to estimates of the litterbag decomposition model without the HPM decomposition module prior. Thus, there is a common pattern across the models: when the models estimate lower $k_0$ due to the HPM decomposition module prior, they have to increase their $l_0$ estimates to predict a similar mass loss after the same time. This trading of $l_0$ for $k_0$ allows all model versions to reproduce the observed remaining masses well [---todo: ref to supporting figure here]. This indicates that uncertainties in the litterbag data are large enough to make the HPM decomposition module compatible with the litterbag decomposition rates: The model can estimate the decomposition rate in accordance with predictions of the HPM decomposition module and then change the estimate for $l_0$ such that the predicted remaining masses for the values observed in the litterbag experiments (Fig. \@ref(fig:hpmd-m-conceptual)).-->  

<!--## Relation of $k_0$ to the water table depth

The HPM decomposition module with standard parameter values implies smaller anaerobic decomposition rates and a steeper decrease of decomposition rates from oxic to anoxic conditions than LDM-standard and also than the HPM decomposition module versions where HPM decomposition module parameters were estimated (`r hpmd_model_id_to_name_2("3-3")` and `r hpmd_model_id_to_name_2("3-4")`). In Fig. \@ref(fig:out-p-hpm-mm27-2-mm29-1-mm30-1-p1), the steeper gradient is visible from the steeper slope of the grey lines for `r hpmd_model_id_to_name_2("3-1")` and `r hpmd_model_id_to_name_2("3-2")` (for species with many litterbag experiments across the water table depth gradient *S. spec*, *S. fuscum*, this is also the case for *S. angustifolium* but not as well visible due to the axis scaling), the less steep slope of the black lines for the same models, and the less steeper slope of the grey lines for `r hpmd_model_id_to_name_2("3-3")` and `r hpmd_model_id_to_name_2("3-4")`, where HPM decomposition module parameters were estimated. Fig. ... shows the difference in $k_0$ predicted by `r hpmd_model_id_to_name_2("3-1")` and the remaining three HPM decomposition module versions. Whereas the difference is centered around 0 for the HPM decomposition module version for which we did not estimate HPM decomposition module parameters (`r hpmd_model_id_to_name_2("3-2")`), anaerobic decomposition rates are larger for all shown species and aerobic decomposition rates smaller for most than when using standard parameter values. Thus, the HPM decomposition module with standard parameter values predicts a steeper decrease of decomposition rates from oxic to anoxic conditions and overall smaller anaerobic decomposition rates. 





## Differences in HPM decomposition module parameter estimates to the standard parameter values

[---todo:continue]





## Differences in parameter values of the HPM decomposition module and its modifications

#### The HPM decomposition module with standard parameter values can fit litterbag data due to large uncertainties in available litterbag data. {.unnumbered}

`r hpmd_model_id_to_name_2("3-2")` suggests that it is possible to fit remaining masses in litterbag experiments without changing the standard HPM decomposition module parameter values, simply by adjusting $k_0$ and $l_0$ estimates from the litterbag decomposition model such that they fit the HPM decomposition module predictions. Fig. \@ref(fig:out-p-hpm-mm27-2-mm29-1-mm30-1-p1) shows that `r hpmd_model_id_to_name_2("3-2")` can reproduce these adjusted $k_0$ estimates. Fig. \@ref(fig:out-p-hpm-mm27-2-mm29-1-mm30-1-p2) shows that this better fit is mainly achieved by adjusting $k_0$ estimates from the litterbag decomposition model (mainly decreased) to the HPM decomposition module and not because of differences in peat properties estimated from the litterbag data. In combination with the improved fit of `r hpmd_model_id_to_name_2("3-2")`, this indicates that uncertainties in the litterbag data are large enough to make the HPM decomposition module compatible with the litterbag decomposition rates: The model can estimate the decomposition rate in accordance with predictions of the HPM decomposition module and then change the estimate for $l_0$ such that the predicted remaining masses for the values observed in the litterbag experiments (Fig. \@ref(fig:hpmd-m-conceptual)). However, the standard HPM decomposition module parameters are not necessarily (most) compatible with the data, as indicated by the difference to the $k_0$ and $l_0$ estimates without the HPM decomposition module as prior. This indicates that a better test of the HPM decomposition module requires more accurate estimates of initial leaching losses.

#### Estimates for $k_0$, $l_0$, and $k_{0,i}$ differ between modifications of the HPM decomposition module. {.unnumbered}

The two modifications of the HPM decomposition module where HPM parameters were estimated from litterbag data (`r hpmd_model_id_to_name_2("3-3")`, `r hpmd_model_id_to_name_2("3-4")`) also differed in the magnitude of $l_0$ and $k_0$ estimates, as well as the maximum possible initial decomposition rate for each species ($k_{0,i}$). However, they had very similar estimates for the other HPM decomposition module parameters ($c_1$, $W_{opt}$, $f_{min}$, $c_2$).

`r hpmd_model_id_to_name_2("3-3")` estimated larger initial leaching losses and smaller decomposition rates than the litterbag decomposition model from @Teickner.2025 alone, similar to `r hpmd_model_id_to_name_2("3-2")` (Fig. \@ref(fig:out-sdm-all-models-p2)). This is particularly the case for *S. angustifolium*, for which the separate litterbag decomposition model estimated much larger average decomposition rates and smaller initial leaching losses than the litterbag decomposition model in `r hpmd_model_id_to_name_2("3-3")` (Fig. \@ref(fig:out-p-hpm-mm27-2-mm29-1-mm30-1-p2)). In contrast to this, initial leaching losses and smaller decomposition rates estimated by `r hpmd_model_id_to_name_2("3-4")` were more similar to estimates of the separate litterbag decomposition model from @Teickner.2025 (Fig. \@ref(fig:out-sdm-all-models-p2)). This indicates again that a better test of the HPM decomposition module is possible when $l_0$ can be estimated more accurately.

In line with this, the maximum possible decomposition rates for the species differ between the HPM decomposition module modifications. `r hpmd_model_id_to_name_2("3-4")` estimates a larger average maximum possible decomposition rate, particularly for *S. angustifolium*, than the other models (Fig. \@ref(fig:out-p-hpm-mm27-2-mm29-1-mm30-1-p2) and supporting Fig. \@ref(si-fig:sup-hpmd-plot-6)).


#### Estimates for $c_1$, $W_{opt}$, $f_{min}$, $c_2$ are similar between modifications of the HPM decomposition module. {.unnumbered}

In contrast to estimates for $k_0$, $l_0$, and $k_{0,i}$, the other HPM decomposition module parameters had similar estimates for `r hpmd_model_id_to_name_2("3-3")` and `r hpmd_model_id_to_name_2("3-4")` and as a consequence relative differences of decomposition rates along the water table depth gradient are very similar between all models (Fig. \@ref(fig:out-p-hpm-mm27-2-mm29-1-mm30-1-p2)). Estimates for $f_{min}$ did not differ much to the prior value and the power-scaling sensitivity analysis indicates a weak influence of the data (supporting information \@ref(si-sup-12)) and therefore that available litterbag data provide only little information about minimum decomposition rates under anoxic conditions.


#### Litterbag data do not indicate a clear relation of $l_0$ to the degree of saturation in `r hpmd_model_id_to_name_2("3-4")`. {.unnumbered}

```{r}
tar_load(hpmd_stan_fit_4)
tar_load(hpmd_data_stan_4)
```


`r hpmd_model_id_to_name_2("3-4")` suggests that both positive and negative relations of $l_0$ to the degree of saturation are compatible with available litterbag data (95% confidence intervals for the slope (logit scale): (`r hpmd_stan_fit_4 |> tidybayes::spread_rvars(hpm_l_2_p3) |> dplyr::mutate(hpm_l_2_p3 = hpm_l_2_p3 * hpmd_data_stan_4$hpm_l_2_p3_p2 + hpmd_data_stan_4$hpm_l_2_p3_p1) |> dplyr::pull(hpm_l_2_p3) |> posterior::quantile2() |> round(2) |> knitr::combine_words(and = ", ")`), supporting Fig. \@ref(si-fig:sup-hpmd-plot-7)). In contrast to `r hpmd_model_id_to_name_2("3-2")` and `r hpmd_model_id_to_name_2("3-3")`, it estimates on average smaller initial leaching losses, more similar to estimates of the litterbag decomposition model not combined with the HPM decomposition module [@Teickner.2025] (Fig. \@ref(fig:out-sdm-all-models-p2)).





## Comparison between standard HPM decomposition module parameter values defined in @Frolking.2010 and estimated from litterbag data

Figure \@ref(fig:out-mm30-hpm-test-p2) shows marginal posterior densities of the maximum possible decomposition rate for each species and the four other HPM decomposition module parameters for `r hpmd_model_id_to_name_2("3-3")`, with standard parameter values as defined in @Frolking.2010 indicated by vertical lines. For both `r hpmd_model_id_to_name_2("3-3")` and `r hpmd_model_id_to_name_2("3-4")`, the range of parameter estimates contains the standard values, but there are large posterior probabilities that $c_2$ ($P_\text{`r hpmd_model_id_to_name_2("3-3")`}(c_2>`r hpmd_hpm_standard_parameter_values |> dplyr::filter(variable == "m68_p2") |> dplyr::pull(value)`~\mathrm{m}) = `r hpmd_stan_draws_3 |> dplyr::filter(index_hpm) |> dplyr::slice(1) |> dplyr::mutate(res = posterior::Pr(m68_p2 > ( hpmd_hpm_standard_parameter_values |> dplyr::filter(variable == "m68_p2") |> dplyr::pull(value)))) |> dplyr::pull(res) |> round(2)`$ and $P_\text{`r hpmd_model_id_to_name_2("3-4")`}(c_2>`r hpmd_hpm_standard_parameter_values |> dplyr::filter(variable == "m68_p2") |> dplyr::pull(value)`~\mathrm{m}) = `r hpmd_stan_draws_4 |> dplyr::filter(index_hpm) |> dplyr::slice(1) |> dplyr::mutate(res = posterior::Pr(m68_p2 > ( hpmd_hpm_standard_parameter_values |> dplyr::filter(variable == "m68_p2") |> dplyr::pull(value)))) |> dplyr::pull(res) |> round(2)`$) and $W_{opt}$ ($P_\text{`r hpmd_model_id_to_name_2("3-3")`}(W_{opt}>`r hpmd_hpm_standard_parameter_values |> dplyr::filter(variable == "m69_p1") |> dplyr::pull(value)`~\mathrm{L}_\mathrm{water}~\mathrm{L}_\mathrm{pores}^{-1}) = `r hpmd_stan_draws_3 |> dplyr::filter(index_hpm) |> dplyr::slice(1) |> dplyr::mutate(res = posterior::Pr(m69_p1 > (hpmd_hpm_standard_parameter_values |> dplyr::filter(variable == "m69_p1") |> dplyr::pull(value)))) |> dplyr::pull(res) |> round(2)`$ and $P_\text{`r hpmd_model_id_to_name_2("3-4")`}(W_{opt}>`r hpmd_hpm_standard_parameter_values |> dplyr::filter(variable == "m69_p1") |> dplyr::pull(value)`~\mathrm{L}_\mathrm{water}~\mathrm{L}_\mathrm{pores}^{-1}) = `r hpmd_stan_draws_4 |> dplyr::filter(index_hpm) |> dplyr::slice(1) |> dplyr::mutate(res = posterior::Pr(m69_p1 > (hpmd_hpm_standard_parameter_values |> dplyr::filter(variable == "m69_p1") |> dplyr::pull(value)))) |> dplyr::pull(res) |> round(2)`$) have larger values than the standard parameter values, indicating a discrepancy between the HPM decomposition module and available litterbag data (Fig. \@ref(fig:out-mm30-hpm-test-p2) and supporting Fig. \@ref(si-fig:sup-hpmd-plot-4-4)).




Both models also estimate a large posterior probability ($>95$%) that `r dplyr::intersect(hpmd_stan_draws_3_k0i |> dplyr::filter(Pr(m68_p3_2 > k0) > 0.95) |> dplyr::pull(taxon_rank_value_pretty) |> unique(), hpmd_stan_draws_4_k0i |> dplyr::filter(Pr(m68_p3_2 > k0) > 0.95) |> dplyr::pull(taxon_rank_value_pretty) |> unique()) |> knitr::combine_words()` have a larger, and that  `r dplyr::intersect(hpmd_stan_draws_3_k0i |> dplyr::filter(Pr(m68_p3_2 < k0) > 0.95) |> dplyr::pull(taxon_rank_value_pretty) |> unique(), hpmd_stan_draws_4_k0i |> dplyr::filter(Pr(m68_p3_2 < k0) > 0.95) |> dplyr::pull(taxon_rank_value_pretty) |> unique()) |> knitr::combine_words()` has a smaller maximum possible decomposition rate ($k_{0,i}$) than the standard values for the respective PFT (Fig. \@ref(fig:out-mm30-hpm-test-p2) and supporting Fig. \@ref(si-fig:sup-hpmd-plot-4-4)). However,estimates for $k_{0,i}$ were very variable for the same species when different subsets of the litterbag data were used to estimate the model in the cross-validation (compare with the previous subsection). This indicates that samples of the same species from different studies have a large variability in $k_{0,i}$ values and therefore the discrepancies found here may change when additional data becomes available.
-->



# Discussion

Our aims were to test whether the HPM decomposition module fits decomposition rates estimated from available litterbag experiments, to estimate HPM decomposition module parameters from available litterbag experiments, to understand what factors could cause differences in parameter estimates to the standard values, and to check whether the estimates from litterbag data could imply significant differences in peat accumulation predicted by the HPM compared to the standard parameter values.  

The parameter estimates derived from available litterbag data suggest differences in the control of decomposition rates compared to the standard parameter values: the HPM decomposition module with standard parameter values predicts a steeper decrease of decomposition rates from oxic to anoxic conditions and smaller anaerobic decomposition rates for several species than estimated from LDM-standard and the models that estimate HPM decomposition module parameters from available litterbag data. These differences imply larger estimates for $W_{opt}$, the degree of saturation where decomposition rates are maximal, and $c_2$, the anoxia scale length (the parameter that controls how strong decomposition rates decrease below the water table depth). We will show here, by comparing parameter estimates to results from sensitivity analyses of the HPM, that the new parameter estimates can cause large differences in long-term peat accumulation predicted by the HPM. 

Our analysis suggests that the HPM decomposition module with standard parameter values fits available litterbag data, but our modifications, where $W_{opt}$, $c_2$, and (for some species) $k_{0,i}$ estimates significantly differ from the standard values, have equivalent fit. This can be explained by two mechanisms: first, the litterbag decomposition model explains mass loss by initial leaching and decomposition. Thus, remaining masses reported in a litterbag experiment can be fitted either by assuming a larger $l_0$ and smaller $k_0$, or by assuming a smaller $l_0$ and larger $k_0$. By this first mechanism, the litterbag decomposition model can first estimate $k_0$ to agree with the HPM decomposition module and then adjust $l_0$ to fit the remaining masses of the litterbag experiments. The second mechanism is the impact of the design of available *Sphagnum* litterbag experiments on the accuracy of $l_0$ and $k_0$ estimates: initial leaching losses can explain mass losses only at the start of the experiment (equation \@ref(eq:decomposition-solution-2-with-leaching-1)), but decomposition explains a continuous mass loss. It is therefore possible to estimate $l_0$ and $k_0$ accurately when remaining masses shortly after the start of the experiment are recorded, but the majority of litterbag experiments collects the first litterbags only after half a year or later [@Teickner.2025]. This causes large errors in $l_0$ and $k_0$ estimates and therefore allows the model to adjust $l_0$ and $k_0$ by the first mechanism, such that all model versions have equivalent fit to remaining masses while also fitting decomposition rates suggested by different HPM decomposition module priors. Improved litterbag experiments are needed for more accurate tests of any peatland decomposition module and for obtaining parameter estimates accurate enough to allow even only approximate predictions of long-term peat accumulation. Applications of the HPM should consider this variability in parameter estimates compatible with available litterbag experiments.

In the next subsections, we first evaluate the reliability of our test. We discuss whether the identified parameter value differences could be an artifact of using heterogeneous litterbag data, and we discuss how compatible the new HPM decomposition module parameter estimates are with other studies that analyzed how decomposition rates differ in dependency of water availability or that estimated $c_2$ from peat core data. Second, we address the remaining aims: we discuss what factors could cause the larger anaerobic decomposition rates and, in some cases, smaller aerobic decomposition rates estimated by the litterbag decomposition model, and we discuss what implications the differences between estimated and standard parameter values have for peat accumulation predicted by the HPM. Finally, we give recommendations for improving tests of peat decomposition modules. 


<!--Our aims were to test whether the HPM decomposition module can predict litterbag decomposition rates for different *Sphagnum* species along the gradient from oxic to anoxic conditions, and to test whether HPM decomposition module parameters estimated from litterbag data are compatible with the HPM standard values.

Our analysis suggests that the HPM decomposition module with standard parameter values can fit available litterbag data, but only because the uncertainties in litterbag data are large enough to support a range of parameter values. The price to be paid for this is to assume larger initial leaching losses and smaller decomposition rates than estimated with the litterbag decomposition model alone [@Teickner.2025] (Fig. \@ref(fig:out-sdm-all-models-p2)). Comparable or better fits could be achieved by estimating HPM decomposition module parameters from litterbag data (`r hpmd_model_id_to_name_2("3-3")` and `r hpmd_model_id_to_name_2("3-4")`) and similar decomposition rate and initial leaching losses as estimated from litterbag data alone were predicted by a model that assumes smaller initial leaching losses (`r hpmd_model_id_to_name_2("3-4")`). Thus, decomposition rates are either underestimated by the original HPM decomposition module or overestimated by our modifications due to uncertainty about initial leaching losses and this bias amplifies when the decomposition module is used to make long-term predictions. Decomposition rates can be estimated more accurately from litterbag experiments when initial leaching losses are estimated more accurately [@Teickner.2025]. Therefore, an important consequence of our study is that stronger tests of the HPM decomposition module and other peatland models require litterbag experiments that allow to estimate initial leaching losses more accurately than is possible with available experiments. 

Despite these uncertainties, our analysis of the HPM decomposition module suggests that better fits to available litterbag data are possible only if several HPM decomposition module parameter values are adjusted, namely the maximum possible decomposition rates for HPM PFT or *Sphagnum* species ($k_{0,i}$), the optimum degree of saturation for decomposition ($W_{opt}$), and the anoxia scale length ($c_2$). 

In the following sections, we discuss these discrepancies. In particular, we show that they imply a less steep gradient of decomposition rates from oxic to anoxic conditions than assumed by the standard HPM decomposition module. We discuss how reliable this pattern is, considering that the data are from heterogeneous studies, what processes may cause the less steep gradient, and how important the suggested differences in parameter values are for the predicted C accumulation.-->

<!--In supporting information \@ref(sup-7), we present R code to predict decomposition rates and remaining masses in litterbag experiments with different species and water table levels with `r hpmd_model_id_to_name_2("3-4")` [@Teickner.2024b] which can be useful to improve the HPM, test `r hpmd_model_id_to_name_2("3-4")` against novel litterbag data, or plan litterbag studies.-->


<!--## HPM decomposition module parameters for which estimates differ from their standard values {#out-discussion-1}

Three HPM decomposition module parameters had estimates contrasting to their standard values:  

1. There is a large posterior probability that $c_2$ is larger than the standard value of `r hpmd_hpm_standard_parameter_values |> dplyr::filter(variable == "m68_p2") |> dplyr::pull(value)` m. $c_2$ is the anoxia scale length of decomposition and is assumed to represent limitation of anaerobic decomposition below the water table depth as a consequence of the accumulation of decomposition end products and depletion of electron acceptors [@Frolking.2010]. A larger value implies larger anaerobic decomposition rates at the same depth below the water table.

2. There is a large posterior probability that $W_{opt}$ is larger than the standard value of `r hpmd_hpm_standard_parameter_values |> dplyr::filter(variable == "m69_p1") |> dplyr::pull(value)` L$_\text{water}$ L$_\text{pores}^{-1}$. $W_{opt}$ is the degree of saturation at which the decomposition rate is largest. Larger values mean that the largest decomposition rates are reached at larger degrees of saturation. 

3. For some species, there is a large posterior probability that $k_{0,i}$ is smaller (`r dplyr::intersect(hpmd_stan_draws_3_k0i |> dplyr::filter(Pr(m68_p3_2 < k0) > 0.95) |> dplyr::pull(taxon_rank_value_pretty) |> unique(), hpmd_stan_draws_4_k0i |> dplyr::filter(Pr(m68_p3_2 < k0) > 0.95) |> dplyr::pull(taxon_rank_value_pretty) |> unique()) |> knitr::combine_words()`) or larger (`r dplyr::intersect(hpmd_stan_draws_3_k0i |> dplyr::filter(Pr(m68_p3_2 > k0) > 0.95) |> dplyr::pull(taxon_rank_value_pretty) |> unique(), hpmd_stan_draws_4_k0i |> dplyr::filter(Pr(m68_p3_2 > k0) > 0.95) |> dplyr::pull(taxon_rank_value_pretty) |> unique()) |> knitr::combine_words()`) than the standard value for the HPM microhabitat class we assigned them to. In addition, $k_{0,i}$ was not consistent between `r hpmd_model_id_to_name_2("3-3")` and `r hpmd_model_id_to_name_2("3-4")` and also differed between models estimated when removing portions of the data during the cross-validation (supporting Fig. \@ref(si-fig:sup-hpmd-plot-5)). $k_{0,i}$ defines how decomposition rates differ between *Sphagnum* species and is therefore an important control of C accumulation if there are vegetation changes. 

Of these parameters, $c_2$, and $k_{0,i}$ are of particular relevance for C accumulation in the HPM, as indicated by previous sensitivity analyses [@Quillet.2013; @Quillet.2013a]. Explaining the discrepancies and finding ways to test them more accurately than possible with available litterbag data should therefore improve our understanding of peat C accumulation.


## Estimated $c_2$ and $W_{opt}$ suggest larger anaerobic decomposition rates relative to aerobic decomposition rates than the standard HPM decomposition module {#out-discussion-2}

The discrepancies in $c_2$ and $W_{opt}$ together imply that anaerobic decomposition rates are larger relative to aerobic decomposition rates and therefore a less steep decrease of decomposition rates from oxic to anoxic conditions (Fig. \@ref(fig:out-p-hpm-mm27-2-mm29-1-mm30-1-p2)). These relative rates are scaled by $k_{0,i}$ to absolute decomposition rates. With $k_{0,i}$ estimated from litterbag experiments, the discrepancies in $c_2$ and $W_{opt}$ also indicate larger anaerobic decomposition rates than assumed by the HPM decomposition module for several species (Fig. \@ref(fig:out-p-hpmd-plot-9)). Therefore, the discrepancies to the HPM indicate a less steep decrease of decomposition rates from oxic to anoxic conditions and, at least for some species, larger absolute anaerobic decomposition rates.

To illustrate that the estimated $c_2$ and $W_{opt}$ imply smaller aerobic and larger anaerobic decomposition rates, we simulated decomposition of *S. fuscum* incubated at different depths in a peatland with water table depth of `r hpmd_simulation_1_newdata_1 |> dplyr::pull(layer_water_table_depth_to_surface_1) |> unique()` cm below the surface, a porosity of `r hpmd_simulation_1_newdata_1 |> dplyr::pull(layer_total_porosity_1) |> unique()` L$_\text{pores}$ L$_\text{sample}^{-1}$, and a minimum water content at the surface of `r hpmd_simulation_1_newdata_1 |> dplyr::pull(minimum_water_content_at_surface_1) |> unique()` g$_\text{water}$ g$_\text{sample}^{-1}$. With these settings, we predicted five sets of average $k_0$: (1) with `r hpmd_model_id_to_name_2("3-4")` ($k_{0,\text{modified}}(\text{`r hpmd_model_id_to_name_2("3-4")`})$). The remaining four sets were also predicted with `r hpmd_model_id_to_name_2("3-4")`, but each time setting one of the HPM decomposition module parameters to their standard value ($k_{0,\text{standard}}(\text{`r hpmd_model_id_to_name_2("3-4")`})$): (2) $c_1$, (3) $W_{opt}$, (4) $f_{min}$, (5) $c_2$. We then computed the difference of $k_0$ from set (1) and (2) to analyze the effect of the new $c_1$ estimate, from set (1) and (3) to analyze the effect of the new $W_{opt}$ estimate, and so on for sets (3) and (4). This gives the difference in decomposition rates of `r hpmd_model_id_to_name_2("3-4")` if we would set individual HPM decomposition module parameters to their standard values. We plotted this difference versus the depth of the water table below the litter (litter at the surface has a value of +40 cm, litter at the water table level of 0 cm, and litter below the water table level has negative values), as shown in Fig. \@ref(fig:out-sdm-parameters-standard-vs-estimated-p1).

With the standard $W_{opt}$ value, `r hpmd_model_id_to_name_2("3-4")` predicts larger decomposition rates above and smaller decomposition rates below the water table than when using the parameter values estimated from litterbag data. Similarly, setting $c_2$ to its standard value also results in smaller decomposition rates below the water table level. The other parameters do not have a qualitative influence (Fig. \@ref(fig:out-sdm-parameters-standard-vs-estimated-p1)). Thus, the discrepancies in $W_{opt}$ and $c_2$ are the main drivers of the less steep decrease of decomposition rates from oxic to anoxic conditions in `r hpmd_model_id_to_name_2("3-4")` compared to the standard HPM decomposition module.-->





## Reliability of the identified discrepancies {#out-discussion-3}

Before analyzing potential causes of the discrepancies found for $c_2$ and $W_{opt}$ we first ask if combining different litterbag experiments is reliable evidence for the less steep gradient in decomposition rates from oxic to anoxic conditions.

If we take a look at the misfits of the standard HPM decomposition module (`r hpmd_model_id_to_name_2("3-1")`) shown in Fig. \@ref(fig:out-p-hpm-mm27-2-mm29-1-mm30-1-p2), many, but not all underestimations of aerobic decomposition rates could have been caused by other factors: for example for *S. balticum* the difference may have been caused by differences in the two litterbag experiments from which we collected the data because the replicate with positive water table depth is from @Strakova.2010, whereas the two others are from @Makila.2018 (Fig. \@ref(fig:out-p-hpm-mm27-2-mm29-1-mm30-1-p2)). The less pronounced gradient in measured decomposition rates above the water table depth is, however, also visible for *S. fuscum* replicates within the same study and in addition similar across these (independent) studies (Fig. \@ref(fig:out-p-hpm-mm27-2-mm29-1-mm30-1-p2), supporting information \@ref(si-sup-8)) [@Johnson.1991; @Golovatskaya.2017; @Makila.2018], indicating that this pattern cannot be explained in all cases by differences between studies. In addition, during the cross-validation, we removed data from individual studies from the model and the remaining subsets still resulted in similar estimates for $c_2$ and $W_{opt}$ (supporting Fig. \@ref(si-fig:sup-hpmd-plot-5)). Finally, numerous previous studies suggest that water table depth is an important control of decomposition rates [e.g., @Blodau.2004] and one may therefore expect that also between different studies decomposition rate differences should be controlled to a large degree by differences in water table depths. Thus, even with the heterogeneous litterbag data currently available, a less steep gradient of decomposition rates from oxic to anoxic conditions appears to be replicable between studies and species. To fully rule out that this pattern may be biased by heterogeneous litterbag data and biases of the litterbag decomposition model, controlled litterbag experiments that systematically estimate decomposition rates along the gradient from oxic to anoxic conditions are needed.

The $W_{opt}$ estimate suggested by `r hpmd_model_id_to_name_2("3-4")` is near the average optimum of heterotrophic respiration estimated across a range of mineral soils [@Moyano.2013]. The estimate is also in line with a study where the largest decomposition rates of the same litter type were observed at or just above the average water table level in hummocks [@Belyea.1996], and with maximum CO$_2$ production rates around 13 cm above the water table level in a mesocosm study [@Blodau.2004]. According to the ModGberg model the degree of saturation at this depth is near the $W_{opt}$ estimate suggested by `r hpmd_model_id_to_name_2("3-3")` and `r hpmd_model_id_to_name_2("3-4")`. For example, for our simulation analysis used to produce Fig. \@ref(fig:out-sdm-parameters-standard-vs-estimated-p1), the average $W_{opt}$ estimated by model `r hpmd_model_id_to_name_2("3-4")` (`r hpmd_stan_draws_4 |> dplyr::filter(index_hpm) |> dplyr::slice(1) |> dplyr::pull(m69_p1) |> mean() |> round(2)` L$_\text{water}$ L$_\text{pores}^{-1}$) is reached around `r hpmd_simulation_1_newdata_1 |> dplyr::filter(layer_degree_of_saturation_1 <= (hpmd_stan_draws_4 |> dplyr::filter(index_hpm) |> dplyr::slice(1) |> dplyr::pull(m69_p1) |> mean())) |> dplyr::slice_tail(n = 1) |> dplyr::mutate(res = sample_depth_lower - layer_water_table_depth_to_surface_1) |> dplyr::pull(res) |> abs()` cm above the water table level, as shown in Fig. \@ref(fig:out-sdm-parameters-standard-vs-estimated-p2). At shallower depths, the degree of saturation decreases below the $W_{opt}$ estimate and this would decrease decomposition rates as observed in @Belyea.1996. In contrast, according to the the ModGberg model, a degree of saturation corresponding to the standard $W_{opt}$ value (`r hpmd_hpm_standard_parameter_values |> dplyr::filter(variable == "m69_p1") |> dplyr::pull(value)` L$_\text{water}$ L$_\text{pores}^{-1}$) is reached at shallower depths and in the same simulation with this standard $W_{opt}$ value, no pronounced sub-surface peak in decomposition rates is observed (supporting Fig. \@ref(si-fig:sup-hpmd-simulation-1-plot-5)). In hollows, the optimum degree of saturation suggested by `r hpmd_model_id_to_name_2("3-4")` is reached near the surface for either $W_{opt}$ value (supporting Fig. \@ref(si-fig:sup-hpmd-simulation-1-plot-5)). Thus, a larger value for $W_{opt}$ would be compatible with results from several previous studies.

Larger and smaller $c_2$ than the standard value have been estimated for several peatland cores with the HPM and a modified version with monthly time step [@Quillet.2015; @Treat.2021; @Treat.2022]. Smaller values have been estimated for tropical peatlands [@Kurnianto.2015]. To our knowledge, no litterbag experiment directly estimated $c_2$. A difficulty is that available litterbag experiments cover only a comparatively small depth range below the water table level (at most around 30 cm, Fig. \@ref(fig:out-p-hpm-mm27-2-mm29-1-mm30-1-p2)) and therefore gradients in anaerobic decomposition rates across larger depths below the water table currently cannot be estimated with available litterbag data. 

The estimates for the maximum possible decomposition rate ($k_{0,i}$) have large errors and removal of data during the cross-validation caused larger relative differences in $k_{0,i}$ estimates compared to $W_{opt}$ and $c_2$ (supporting Fig. \@ref(si-fig:sup-hpmd-plot-5)). On the one hand, this variability indicates that available litterbag data are not sufficient to estimate $k_{0,i}$ accurately and that our assignment of *Sphagnum* species to HPM PFT may not be optimal, but on the other hand, this variability may also indicate that categorizing *Sphagnum* species into three PFT may not accurately describe the variability of maximum possible decomposition rates. Several studies suggest that diverse aspects of litter chemistry may increase $k_{0,i}$ [@Turetsky.2008; @Bengtsson.2018]. However, we are not aware of studies that systematically analyze what factors control $k_{0,i}$ within the same species.


(ref:out-sdm-parameters-standard-vs-estimated-p2-caption) Decomposition rates predicted with `r hpmd_model_id_to_name_2("3-4")` ($k_{0,\text{modified}}(\text{`r hpmd_model_id_to_name_2("3-4")`})$) for *S. fuscum* (hummocks), using either the standard value for $W_{opt}$ or the $W_{opt}$ value estimated by `r hpmd_model_id_to_name_2("3-4")` versus depth of the litter below the peat surface. The horizontal line is the average water table depth. Shaded areas are central confidence intervals with probabilities given in the  figure legend.     

```{r out-sdm-parameters-standard-vs-estimated-p2, fig.cap='(ref:out-sdm-parameters-standard-vs-estimated-p2-caption)', out.width="60%"}
knitr::include_graphics(tar_read(hpmd_simulation_1_plot_2))
```


## Water table fluctuations may explain the discrepancies in $c_2$ and $W_{opt}$ and larger anaerobic and smaller aerobic decomposition rates. {#out-discussion-4}

The HPM decomposition module predicts decomposition rates based on average annual water table depths [@Frolking.2010] and ignores water table fluctuations. Our evaluation of the HPM decomposition module also assumed an average water table depth during the litterbag experiments and the HPM decomposition module translated this into a clear pronounced transition between anaerobic and aerobic decomposition rates (Fig. \@ref(fig:out-p-hpm-mm27-2-mm29-1-mm30-1-p2)). In reality, water table levels fluctuate and this causes transient and nonlinear changes in decomposition rates due to variations in the availability of oxygen and other electron acceptors, flushing of end products of anaerobic decomposition, and possibly other factors [@Siegel.1995; @Blodau.2003; @Blodau.2004; @Beer.2007; @Knorr.2009; @Walpen.2018; @Campeau.2021; @Kim.2021; @Treat.2022; @Obradovic.2023]. A possible explanation why the gradient in decomposition rates from oxic to anoxic decomposition is less steep across litterbag experiments, on average, than suggested by the standard HPM decomposition module could therefore be that an averaging effect of fluctuating water table levels on both aerobic and anaerobic decomposition rates is neglected by the HPM decomposition module. An additional factor may be that litterbags cover a depth range and therefore the decomposition rate estimate is an average over the depth covered by the litterbag. If moisture conditions vary over this depth, the decomposition rate estimate also averages over moisture conditions, with similar effects as the temporal average caused by water table fluctuations.

If this is the case, $c_2$ would have to be re-interpreted as transition parameter that accounts for both limitation of anaerobic decomposition under anoxic conditions and the effects of periodically oxic conditions. Similarly, $W_{opt}$ would have to be re-interpreted as the optimum average degree of saturation for decomposition under water table level variations and its value would be necessarily different from the optimum degree of saturation for depolymerization under static degree of saturation.

Adjusting the HPM decomposition module parameters as implied by our modified models may be an easy way to account for the effect of sub-annual variation in water table levels on decomposition rates, if the discrepancies are caused by fluctuating water tables and if the model is representative for different effects variations in water table level may have on decomposition rates (e.g., short-term fluctuations compared to seasonal water table variations compared to prolonged droughts). What we have not considered due to limited data is that $c_2$ can be expected to depend on long-term changes in groundwater flow [e.g., @Siegel.1995] or site-specific differences in hydrology and other factors [e.g., @Frolking.2010; @Treat.2021; @Treat.2022]. Therefore, $c_2$ can be expected to differ between litterbag studies and our data only indicate that $c_2$ is larger on average, whereas more research is necessary to estimate and understand site-specific controls of $c_2$ and how a change in hydrology controls $c_2$. Similarly, $W_{opt}$ may differ between sites and over time. It would be interesting to know whether litterbag experiments can quantify these controls and whether $c_2$ estimated from litterbag experiments is generally larger in peatlands with larger water table fluctuations.  
It is also worth mentioning that a modification of the HPM, HPM-Arctic [@Treat.2021], has a seasonally dynamic WTD and this modification may account for at least a part of the discrepancies we observed here. Unfortunately, most available litterbag data do not report WTD at sufficient temporal resolution to test whether standard HPM parameter values are more compatible with litterbag data when such seasonal variations in WTD are considered. 


## Implications of the discrepancies in $W_{opt}$, $c_2$, and $k_{0,i}$ for long-term C accumulation {#out-discussion-5}

A larger $c_2$ implies larger anaerobic decomposition and may thus indicate that the HPM decomposition module underestimates anaerobic decomposition rates. Previous global and local sensitivity analyses, where HPM parameter values were varied in broad ranges and environmental conditions were varied, identified $c_2$ as influential for C accumulation in the HPM [@Quillet.2013; @Quillet.2013a].

If $c_2$ is varied within the range from the standard value (`r hpmd_hpm_standard_parameter_values |> dplyr::filter(variable == "m68_p2") |> dplyr::pull(value)` m) to the average posterior estimate from `r hpmd_model_id_to_name_2("3-4")` (`r hpmd_stan_draws_4 |> dplyr::filter(index_hpm) |> dplyr::slice(1) |> dplyr::pull(m68_p2) |> mean() |> round(2)` m), this would cause differences in predicted C accumulation of a maximum of ca. 20% in the sensitivity experiment of @Quillet.2013 (depending on precipitation, Fig. 1 c in @Quillet.2013). If values are changed across the complete posterior range compatible with litterbag data and if other HPM parameters would also be varied, the effect would be even larger (Fig. 2 c in @Quillet.2013). 

Due to parameter interactions and feedbacks, an increase in anaerobic decomposition rates can result in smaller or larger C accumulation of the HPM, depending on environmental conditions [@Quillet.2013]. Small anaerobic decomposition may cause too rapid C accumulation resulting in a low water table level, a thick aerobic zone, and thus smaller overall C accumulation after a longer time. Larger anaerobic decomposition may result in higher water table levels and this can increase C accumulation in the long-term. Too large anaerobic decomposition decreases C accumulation [@Quillet.2013].

A larger $W_{opt}$ implies that the largest aerobic decomposition rates are reached under more saturated conditions. $W_{opt}$ has not been identified as influential in a sensitivity analysis of the HPM [@Quillet.2013], but as shown above, it contributes to the less steep decrease of decomposition rates from oxic to anoxic conditions. Importantly, since the HPM does not have a seasonally resolved water table depth, the two sensitivity analyses did not consider how seasonal variations of the water table depth may control long-term C accumulation, and consequently the re-interpreted $W_{opt}$ may be more important to long-term C accumulation than previously assumed. In addition, `r hpmd_model_id_to_name_2("3-4")` suggests an average $W_{opt}$ value of `r hpmd_stan_draws_4 |> dplyr::filter(index_hpm) |> dplyr::slice(1) |> dplyr::pull(m69_p1) |> mean() |> round(2)` L$_\text{water}$ L$_\text{pores}^{-1}$, which is outside the range of values tested in @Quillet.2013 (0.3 to 0.5 L$_\text{water}$ L$_\text{pores}^{-1}$). This implies that the sensitivity of long-term C accumulation to $W_{opt}$ has been evaluated over a too small range.

A larger $k_{0,i}$ increases decomposition rates for a species and *Sphagnum* $k_{0,i}$ are particularly relevant for many peatlands because the bulk of the peat is *Sphagnum* peat. In the sensitivity analysis in @Quillet.2013a, $k_{0, \text{hummock}}$ had large interaction effects with other parameters of the HPM and therefore could either cause larger or smaller peat accumulation, depending on environmental conditions, other parameters, and what vegetation shifts occur in a specific case. Similar to $W_{opt}$, our $k_{0,i}$ estimates have errors that are larger than the range of values tested in @Quillet.2013a. For example, for hummock *Sphagna*, $k_{0,i}$ was varied from `r paste(round(0.05 * c(0.75, 1.25), 2), collapse = " to ")` yr$^{-1}$, whereas average estimates for $k_{0,i}$ of `r hpmd_model_id_to_name_2("3-4")` for species assigned to the hummock PFT range from `r hpmd_stan_draws_4 |> dplyr::filter(index_hpm & hpm_microhabitat == "Hummock") |> dplyr::pull(m68_p3_2) |> mean() |> range() |> round(2) |> paste(collapse = " to ")` yr$^{-1}$. As mentioned above, this range of $k_{0,i}$ estimates may be biased because of the difficulty to assign *Sphagnum* species to HPM PFT, but from a different perspective, this is an additional error source for $k_{0,i}$ estimates that should be considered in sensitivity analyses unless more evidence becomes available to define PFT and their maximum possible decomposition rates.

A further aspect that needs to be considered is that `r hpmd_model_id_to_name_2("3-3")` and `r hpmd_model_id_to_name_2("3-4")` estimate parameter distributions based on available data, whereas existing studies defined fixed parameter values or ranges of parameter values based on expert knowledge. Based on @Quillet.2013, the uncertainties would cause non-negligible differences in predicted long-term C accumulation. For example, values within the uncertainty range of $c_2$ estimated by `r hpmd_model_id_to_name_2("3-4")` ((`r hpmd_stan_draws_4 |> dplyr::filter(index_hpm) |> dplyr::slice(1) |> dplyr::pull(m68_p2) |> posterior::quantile2(probs = c(0.025, 0.975)) |> round(2) |> knitr::combine_words(and = ", ")`), 95% confidence interval), would imply differences up to 100 kg m$^{-2}$ of accumulated C over 5000 years in some simulations (Fig. 1 (c) in @Quillet.2013, with a maximum total accumulation of ca. 430 kg$_\text{C}$ m$^{-2}$). Simulations of remaining masses for different *Sphagnum* species under different conditions also indicate large uncertainties in predicted remaining masses (supporting info \@ref(si-sup-11)). This implies that more work is required to estimate parameters accurately enough to detect even relative large differences among peatland models and between model predictions and peat cores.   

Summarized, based on existing sensitivity analyses of the HPM the parameter discrepancies suggested by `r hpmd_model_id_to_name_2("3-3")` and `r hpmd_model_id_to_name_2("3-4")` can translate into non-negligible differences in long-term C accumulation rates. They also imply gaps in previous sensitivity analyses of the HPM, namely that $W_{opt}$ and possibly $k_{0,i}$ (for some species) have been analyzed over a too restricted value range and may play a more important role if water table fluctuations are taken into account. 


<!--## Large errors in $k_{0,i}$ estimates for individual species cause large errors in decomposition rates predicted by the HPM decomposition module {#out-discussion-7}

We found some discrepancies between the maximum potential decomposition rates ($k_{0,i}$) `r hpmd_model_id_to_name_2("3-4")` estimated for some species and the standard HPM values after assigning species to the three HPM microhabitat PFT (hollow, lawn, hummock *Sphagnum* mosses), however as noted above, these discrepancies were neither consistent between the two modifications of the HPM decomposition module (`r hpmd_model_id_to_name_2("3-3")` and `r hpmd_model_id_to_name_2("3-4")`) (supporting information \@ref(si-sup-5)), nor when `r hpmd_model_id_to_name_2("3-4")` was fitted to different subsets of the data during cross-validation (supporting Fig. \@ref(si-fig:sup-hpmd-plot-5)). 

Altogether, this indicates that the $k_{0,i}$ for many of the *Sphagnum* species are difficult to estimate from available litterbag data and more research should address this task. For example, `r hpmd_model_id_to_name_2("3-4")` could be extended, with suitable data, by modelling how $k_{0,i}$ is controlled by factors such as temperature or within-species differences in litter chemistry. 

We expect that better estimating $k_{0,i}$ is an important step to improve the predictive accuracy of the HPM decomposition module because the cross-validation of `r hpmd_model_id_to_name_2("3-4")` indicated a larger RMSE$_\text{test}$ than RMSE$_\text{train}$, with only small variability in estimates of $c_1$, $W_{opt}$, $f_{min}$, and $c_2$, but much more variability in estimates of $k_{0,i}$. This indicates that a large part of the difference between RMSE$_\text{test}$ and RMSE$_\text{train}$ of `r hpmd_model_id_to_name_2("3-4")` may be explained by missing information about $k_{0,i}$. 

Moreover, as noted above, $k_{0,i}$ scales the relative differences in anaerobic versus aerobic decomposition rates to absolute decomposition rates. For example, as shown in Fig. \@ref(fig:out-p-hpmd-plot-9), `r hpmd_model_id_to_name_2("3-4")` indicates that the standard HPM decomposition module underestimates aerobic and anaerobic decomposition rates for *S. angustifolium* and *S. magellanicum aggr.* litterbag data, whereas for *S. fuscum* only anaerobic decomposition rates are underestimated.-->


## How can we improve tests of peatland decomposition modules?

<!--Throughout this study, we have mentioned several limitations of our modeling approach and test of the HPM decomposition module. We summarize these here and derive suggestions how we can improve future tests of peatland decomposition modules:-->
We suggest the following steps to estimate peatland decomposition module parameters more accurately and therefore also to improve the accuracy of tests of peatland decomposition modules:

1. High temporal resolution measurements of WTD: For many available litterbag studies, it is not clear whether reported WTD estimates are unbiased estimates of average WTD (i.e., are derived from high-resolution measurements during the incubation) or biased (due to a too small temporal resolution or coverage). This limitation could be reduced by reporting high temporal resolution WTD measurements along litterbag experiments. Such data are also necessary to investigate whether HPM decomposition module parameters are controlled by WTD fluctuations.

2. Eliminate the need of auxiliary models to estimate the degree of saturation: There is a lack of data on the degree of saturation (or porosity and volumetric water content, from which the degree of saturation could be computed) for available litterbag experiments. For this reason, we used the modified Granberg model to estimate the degree of saturation based on reported WTD and an assumed peat porosity. The modified Granberg model, reported WTD, and our assumed peat porosity are error sources for our test. This limitation could be reduced by measurements of peat porosity and high temporal resolution measurements of volumetric water content during litterbag experiments.

3. Implementing a standard for how to assign *Sphagnum* species to model PFT: The HPM does not specify how to assign *Sphagnum* species to PFT [@Frolking.2010], which makes it difficult to compare litterbag experiments to parameters for HPM PFT. Ideally, peatland models should provide lists of species they assign to certain PFT to facilitate tests. Moreover, available niche data used here to assign species to PFT may be biased by short term measurements during summer that are not in line with average niches defined in peatland models, similar to how transfer model for testate amoebae are suggested to be biased [@Swindles.2015].

3. Decreasing errors in $k_0$ and $l_0$ estimates from litterbag experiments: Our analysis suggests that a comparatively large range of $c_2$, $W_{opt}$, and $k_{0,i}$ estimates in the HPM decomposition module are compatible with available litterbag data because errors in remaining masses are large enough to support a range of $k_0$ and $l_0$ estimates and because of deficiencies in the design of the litterbag experiments. As a consequence, $k_0$ estimates of the litterbag decomposition model can be adjusted to fit predictions of the HPM decomposition module for a range of HPM decomposition module parameter values. We also assume that because of these large errors and a large variability of initial leaching losses due to differences in litter handling [@Teickner.2025], we could not detect an expected positive relation of $l_0$ to the degree of saturation [@Lind.2022]. Future litterbag experiments that aim to improve peatland models should reduce errors of $k_0$ and $l_0$ estimates [e.g., @Teickner.2025]. 

4. Systematic litterbag experiments along the gradient from oxic to anoxic conditions: There are few litterbag experiments available that systematically analyze how decomposition rates differ along the gradient from oxic to anoxic conditions. Problems are that many studies test only few conditions and do not cover depth ranges large enough to estimate the minimum decomposition rate ($f_{min}$) and $c_2$. An ideal study would use litter material of the same species and origin (thus making sure $k_{0,i}$ would be the same for all replicates) and systematically record remaining masses under different degrees of saturation in the same peat material to accurately estimate $W_{opt}$ and $c_1$. Another ideal study would systematically record remaining masses at many depth levels, and deeper than 30 cm below the average annual WTD to allow accurate estimation of $c_2$. Similar experiments could be used to estimate how WTD fluctuations affect decomposition rates along the gradient from oxic to anoxic conditions and how this would change estimates for $W_{opt}$ and $c_2$.

5. Understanding the controls of $k_{0,i}$: Values of $k_{0,i}$ can be assumed to be controlled, among other factors, by litter chemistry. Even though there are studies that analyze how litter chemistry controls decomposition rates [e.g., @Turetsky.2008], there are few that do this systematically [e.g., @Bengtsson.2018] and these do not consider initial leaching losses and thus may confound initial leaching and decomposition, both of which may depend on initial litter chemistry. Studies that systematically change litter chemistry within species would be required to estimate $k_{0,i}$. These estimates would also be useful to define PFT for decomposition modules. 

7. Understanding how $c_2$ and $W_{opt}$ vary between sites and in dependency of peat characteristics: Too few litterbag experiments with too few replicates are available to estimate $c_2$ and $W_{opt}$ separately for individual sites (or how they may vary over time). Systematic litterbag experiments are needed to estimate how environmental conditions control the magnitude of these parameters, for example due to temporal variations in water and oxygen availability or differences in availability of alternative electron acceptors under anoxic conditions.

Systematic and high-quality litterbag experiments that are designed specifically to test peatland decomposition modules are required to achieve these improvements. To support the design of such experiments, we created an R package (hpmdpredict, supporting information \@ref(si-sup-7)) that allows to make predictions with `r hpmd_model_id_to_name_2("3-4")` for hypothetical litterbag experiments and that also allows to change parameter values [@Teickner.2024b]. This could for example be useful to estimate the sample sizes that are required to detect specific differences in remaining masses, to test to what extent litterbag experiments are compatible with `r hpmd_model_id_to_name_2("3-4")`, or to analyze the effect of changing HPM decomposition module parameter values from the standard values or our estimates.


# Conclusions

Based on the litterbag data, the degree of saturation where decomposition is largest ($W_{opt}$) and the anoxia scale length ($c_2$, controls how fast decomposition rates decrease below the average annual WTD) are significantly larger than the standard parameter values. Moreover, maximum possible decomposition rates ($k_{0,i}$) for individual species are overall more variable than implied by the standard HPM decomposition module parameter values. According to previous sensitivity analyses, these parameter estimates imply differences in predicted C accumulation rates of up to 100 kg$_\text{C}$ m$^{-2}$ over 5000 years (with a maximum total C accumulation of ca. 430 kg$_\text{C}$ m$^{-2}$) when compared to the standard parameter values. The differences in HPM parameter estimates imply larger anaerobic decomposition rates for several species and a less steep gradient of decomposition rates from oxic to anoxic conditions. This pattern may be caused by water table fluctuations, differences in groundwater flow, or spatial averaging in litterbag experiments; factors that are currently not explicitly considered both in the HPM decomposition module and available litterbag experiments.

Our analysis suggests that the HPM decomposition module with standard parameter values fits available *Sphagnum* litterbag data, but model versions where HPM decomposition module parameters were estimated from available litterbag data have an equivalent fit. This is caused by two mechanisms: First, remaining masses in litterbag experiments can be explained by initial leaching losses and decomposition. If remaining masses are reported only some time after the initial leaching loss has happened, they can be explained either by small initial leaching losses and a large decomposition rate or by large initial leaching losses and a smaller decomposition rate. Second, the majority of available *Sphagnum* litterbag experiments reports remaining masses only a long time after the initial leaching loss happened. Taken together, this means that available litterbag data are compatible with a broad range of decomposition rates suggested by HPM decomposition module versions with large differences in parameter values. Improved litterbag experiments are needed for more accurate tests of any peatland decomposition module and for obtaining parameter estimates accurate enough to allow even only approximate predictions of long-term peat accumulation. Applications of the HPM and any other peatland model that relies on litterbag data to parameterize its decomposition process should consider that a broad range of decomposition module parameter values is compatible with available litterbag experiments.

The modeling approach used here can be combined with different data sources and peatland decomposition modules and therefore may serve as blueprint for future tests and to obtain more accurate parameter estimates once improved litterbag experiments are available. In light of the large differences in long-term peat accumulation suggested by the parameter estimates, we conclude that it is worth to conduct such litterbag experiments, not only to improve the decomposition module of the HPM, but to improve peatland models in general.



<!--These differences in HPM parameter estimates imply larger anaerobic decomposition rates and a less steep gradient of decomposition rates from oxic to anoxic conditions. Maximum possible decomposition rates ($k_{0,i}$) for individual species are overall more variable than implied by the standard HPM decomposition module parameter values.  
Less limitation of anaerobic decomposition rates than suggested by the HPM would imply differences in predicted C accumulation rates of up to 100 kg$_\text{C}$ m$^{-2}$ over 5000 years (with a maximum total C accumulation of ca. 430 kg$_\text{C}$ m$^{-2}$), according to previous sensitivity analyses.  
The less steep gradient of decomposition rates from oxic to anoxic conditions estimated from litterbag data may be caused by water table fluctuations, differences in groundwater flow, or spatial averaging in litterbag experiments, factors which are currently not explicitly considered both in the HPM decomposition module and available litterbag experiments. Our estimates may be an easy way to account for such effects in the HPM decomposition module if effects of these fluctuations on decomposition rates can be averaged over time as implied by the suggested parameter estimates. 

$W_{opt}$ (degree of saturation where decomposition is largest) and $c_2$ (parameter that controls how strong decomposition rates decrease below the average WTD) estimates are significantly larger than the standard values

Improved litterbag experiments that are designed to test peatland models
Based on previous sensitivity analyses, the estimated differences in parameter values


On the one hand, these results indicate that more high-quality litterbag experiments need to be made available to allow to differentiate between these competitors. On the other hand, our test indicates that the updated estimates of HPM decomposition module parameters currently are as compatible with available litterbag data as the standard values and therefore a more detailed analysis of the consequences of these differences is useful.  

In particular, our results suggest that the HPM decomposition module with standard parameter values predicts a steeper decrease of decomposition rates from oxic to anoxic conditions and smaller anaerobic decomposition rates for several species than estimated from LDM-standard and the models that estimate HPM decomposition module parameters from available litterbag data. These differences imply larger estimates for $W_{opt}$, the degree of saturation where decomposition rates are maximal, and $c_2$, the anoxia scale length (the parameter that controls how strong decomposition rates decrease below the water table depth).



Estimating HPM decomposition module parameters from *Sphagnum* litterbag experiments suggests larger anaerobic decomposition rates and a less steep gradient of decomposition rates from oxic to anoxic conditions than implied by the HPM decomposition module with standard parameter values. With these modifications, the HPM decomposition module fits available litterbag data within the range of uncertainties. However, due to large uncertainties in available litterbag data, particularly about how much of the mass is lost due to initial leaching and how much due to decomposition, the HPM decomposition module with standard values can achieve comparable fits if mass loss in litterbag experiments is explained by larger initial leaching and slower subsequent decomposition. Therefore, stronger tests of the HPM decomposition module require more accurate estimates for initial leaching losses and decomposition rates.

The larger anaerobic decomposition rates and less steep gradient of decomposition rates from oxic to anoxic conditions compared to the HPM decomposition module with standard parameter values are a consequence of larger estimates for the anoxia scale length ($c_2$) and the optimum degree of saturation for decomposition ($W_{opt}$). This discrepancy may be caused by neglecting an increase of decomposition rates below the annual average water table depth due to water table fluctuations, differences in groundwater flow, or spatial averaging in litterbag experiments. Our estimates may be an easy way to account for such effects in the HPM decomposition module if effects of these fluctuations on decomposition rates can be averaged over time as implied by the suggested parameter estimates.  

Less limitation of anaerobic decomposition rates than suggested by the HPM would imply differences in predicted C accumulation rates of up to 100 kg$_\text{C}$ m$^{-2}$ over 5000 years (with a maximum total C accumulation of ca. 430 kg$_\text{C}$ m$^{-2}$), according to previous sensitivity analyses. Future litterbag experiments should improve the accuracy of initial leaching loss and decomposition rate estimates and then test whether the identified parameter discrepancies are reproducible. It would be interesting to know whether the discrepancies can be described by not yet fully considered controls of decomposition rates in dependency of water table fluctuations.-->  


# References {.unnumbered}


---
abstract: |
  The Holocene Peatland Model (HPM) is a widely applied model to understand and predict long-term peat accumulation, but it is difficult to test due to its complexity, measurement errors, and lack of data. Instead of testing the complete model, tests of individual modules may avoid some of these problems. In particular, the HPM decomposition module can be tested with litterbag data, but no such test has been conducted yet.     
    Here, we estimate parameter values of the HPM decomposition module from available *Sphagnum* litterbag experiments included in the Peatland Decomposition Database and with a litterbag decomposition model that considers initial leaching losses. Using either these estimates or the standard parameter values, we test whether the HPM decomposition module fits decomposition rates ($k_0$) in *Sphagnum* litterbag experiments along a gradient from oxic to anoxic conditions.  
    Both litterbag data and model versions where HPM decomposition module parameters were estimated suggest a less steep gradient of decomposition rates from oxic to anoxic conditions and larger anaerobic decomposition rates for several species than the standard parameter values. This discrepancy may be caused by ignoring effects of water table fluctuations on aerobic and anaerobic decomposition rates. Moreover, our analysis suggests that maximum possible decomposition rates of individual species ($k_{0,i}$) vary more than suggested by the standard parameter values of the HPM plant functional types. Based on previous sensitivity analyses of the HPM, the estimated differences to the standard parameter values can cause differences in predicted 5000 year C accumulation up to 100 kg m$^{-2}$.  
    The HPM decomposition module with standard parameter values fits $k_0$ estimated from *Sphagnum* litterbag data, but model versions where HPM decomposition module parameters were estimated and differ significantly have an equivalent fit. The reason why models with different parameter values have equivalent fit is that errors in remaining masses and the design of available litterbag experiments support a range of initial leaching loss and $k_0$ estimates. Consequently, applications of the HPM and any other peatland model should consider that a broad range of decomposition module parameter values is compatible with available litterbag experiments.  
    Improved litterbag experiments are needed for more accurate tests of any peatland decomposition module and for obtaining parameter estimates accurate enough to allow even only approximate predictions of long-term peat accumulation. The modeling approach used here can be combined with different data sources (for example measured degree of saturation) and decomposition modules. In light of the large differences in long-term peat accumulation suggested by the parameter estimates, we conclude that it is worth to conduct such experiments, not only to improve the decomposition module of the HPM, but to improve peatland models in general.
---
